<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport"content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes"/>
  
  
  <title>  Min‘s blog</title>

 
  
    <link rel="icon" href="/img/favicon.png">
  


  <!-- css -->
  <link rel="stylesheet" href="/css/style.css">  
  <!-- Jquery -->
  <script src="//cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script> 
  <!-- Add fancyBox -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script> 
  <script src="/js/gallery.js"></script>
  <!-- javascript --> 
  <script src="/js/mobile.js"></script>  
  <script src="/js/utils.js"></script>    
  <script src="/js/script.js"></script>  
</head> 
  <body> 
    <header class="header">
	
  <nav class="header-nav">       
	
  	<span class="iconfont icon-menu mobile-toggle"></span>  

    <a class="header-logo" href="/"><span>Min&#39;s blog</a>  

    <div class="header-menu">          
              
            

              <a class="header-menu-link" id="header-menu-home" href="/">首页</a>     

            
            
            

              <a class="header-menu-link" id="header-menu-archives" href="/archives">归档</a>     

            
            
            

              <a class="header-menu-link" id="header-menu-categories" href="/categories">分类</a>     

            
            
            

              <a class="header-menu-link" id="header-menu-tags" href="/tags">标签</a>     

            
            
            

              <a class="header-menu-link" id="header-menu-about" href="/about">关于</a>     

            
            
            

              <a class="iconfont icon-menu-search header-menu-link" id="header-menu-search"></a>

            
                
    </div>  
    
  </nav>
</header>

    <div class="container">         
      
        

          <section id="main">  

        

        


<div class="profile sildeUpMin">

		<img class="avatar no-gallery" src="/img/timg.jpeg"  alt="Lose">
					
		<p class="author">Rui Min</p>

		
			<p class="location"><span class="iconfont icon-location"></span>BeiJing CN</p>
		
	
		<div class="social">
   		    	
		<a href="https://github.com/bjcoder" class="iconfont icon-github" target="_blank" title="github"></a>
	        	
		<a href="/" class="iconfont icon-others" target="_blank" title="others"></a>
	    
    	</div>		
</div>

      	  	

  		
    	<article class="article">		
	   
	<div class="article-header">
	    
	     <a class="article-title"  href="/2017/12/15/容器部署Docker入门/">容器部署Docker入门</a>  
	       
		 

		 <time>2017-12-15 </time>    
	</div>


    <div class="article-excerpt">	
	
  	

	  

	  	<h1 id="1-Docker简介"><a href="#1-Docker简介" class="headerlink" title="1.Docker简介"></a>1.Docker简介</h1><h2 id="1-1虚拟化"><a href="#1-1虚拟化" class="headerlink" title="1.1虚拟化"></a>1.1虚拟化</h2><h3 id="1-1-1什么是虚拟化"><a href="#1-1-1什么是虚拟化" class="headerlink" title="1.1.1什么是虚拟化"></a>1.1.1什么是虚拟化</h3><p>在计算机中，虚拟化（英语：Virtualization）是一种资源管理技术，是将计算机的各种实体资源，如服务器、网络、内存及存储等，予以抽象、转换后呈现出来，打破实体结构间的不可切割的障碍，使用户可以比原本的组态更好的方式来应用这些资源。这些资源的新虚拟部份是不受现有资源的架设方式，地域或物理组态所限制。一般所指的虚拟化资源包括计算能力和资料存储。</p>
<p>在实际的生产环境中，虚拟化技术主要用来解决高性能的物理硬件产能过剩和老的旧的硬件产能过低的重组重用，透明化底层物理硬件，从而最大化的利用物理硬件   对资源充分利用</p>
<p>虚拟化技术种类很多，例如：软件虚拟化、硬件虚拟化、内存虚拟化、网络虚拟化(vip)、桌面虚拟化、服务虚拟化、虚拟机等等。</p>
<h3 id="1-1-2虚拟化种类"><a href="#1-1-2虚拟化种类" class="headerlink" title="1.1.2虚拟化种类"></a>1.1.2虚拟化种类</h3><p>（1）全虚拟化架构</p>
<p>虚拟机的监视器（hypervisor）是类似于用户的应用程序运行在主机的OS之上，如VMware的workstation，这种虚拟化产品提供了虚拟的硬件。</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image3.png" alt="image3"></p>
<p>（2）OS层虚拟化架构</p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image4.png" alt="image4"> </p>
<p>（3）硬件层虚拟化</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image5.png" alt="image5"></p>
<p>硬件层的虚拟化具有高性能和隔离性，因为hypervisor直接在硬件上运行，有利于控制VM的OS访问硬件资源，使用这种解决方案的产品有VMware ESXi 和 Xen server</p>
<p>Hypervisor是一种运行在物理服务器和操作系统之间的中间软件层,可允许多个操作系统和应用共享一套基础物理硬件，因此也可以看作是虚拟环境中的“元”操作系统，它可以协调访问服务器上的所有物理设备和虚拟机，也叫虚拟机监视器（Virtual Machine Monitor，VMM）。</p>
<p>Hypervisor是所有虚拟化技术的核心。当服务器启动并执行Hypervisor时，它会给每一台虚拟机分配适量的内存、CPU、网络和磁盘，并加载所有虚拟机的客户操作系统。  宿主机</p>
<p>Hypervisor是所有虚拟化技术的核心，软硬件架构和管理更高效、更灵活，硬件的效能能够更好地发挥出来。常见的产品有：VMware、KVM、Xen等等。Openstack</p>
<h2 id="1-2什么是Docker"><a href="#1-2什么是Docker" class="headerlink" title="1.2什么是Docker"></a>1.2什么是Docker</h2><p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image6.png" alt="image6"></p>
<h3 id="1-2-1容器技术"><a href="#1-2-1容器技术" class="headerlink" title="1.2.1容器技术"></a>1.2.1容器技术</h3><p>在计算机的世界中，容器拥有一段漫长且传奇的历史。容器与管理程序虚拟化（hypervisor virtualization，HV）有所不同，管理程序虚拟化通过中间层将一台或者多台独立的机器虚拟运行与物理硬件之上，而容器则是直接运行在操作系统内核之上的用户空间。因此，容器虚拟化也被称为“操作系统级虚拟化”，容器技术可以让多个独立的用户空间运行在同一台宿主机上。</p>
<p>由于“客居”于操作系统，容器只能运行与底层宿主机相同或者相似的操作系统，这看起来并不是非常灵活。例如：可以在Ubuntu服务中运行Redhat Enterprise Linux，但无法再Ubuntu服务器上运行Microsoft Windows。</p>
<p>相对于彻底隔离的管理程序虚拟化，容器被认为是不安全的。而反对这一观点的人则认为，由于虚拟容器所虚拟的是一个完整的操作系统，这无疑增大了攻击范围，而且还要考虑管理程序层潜在的暴露风险。</p>
<p>尽管有诸多局限性，容器还是被广泛部署于各种各样的应用场合。在超大规模的多租户服务部署、轻量级沙盒以及对安全要求不太高的隔离环境中，容器技术非常流行。最常见的一个例子就是“权限隔离监牢”（chroot jail），它创建一个隔离的目录环境来运行进程。如果权限隔离监牢正在运行的进程被入侵者攻破，入侵者便会发现自己“身陷囹圄”，因为权限不足被困在容器所创建的目录中，无法对宿主机进一步破坏。</p>
<p>最新的容器技术引入了OpenVZ、Solaris Zones以及Linux容器（LXC）。使用这些新技术，容器不在仅仅是一个单纯的运行环境。在自己的权限类内，容器更像是一个完整的宿主机。对Docker来说，它得益于现代Linux特性，如控件组（control group）、命名空间（namespace）技术，容器和宿主机之间的隔离更加彻底，容器有独立的网络和存储栈，还拥有自己的资源管理能力，使得同一台宿主机中的多个容器可以友好的共存。</p>
<p>容器被认为是精益技术，因为容器需要的开销有限。和传统虚拟化以及半虚拟化相比，容器不需要模拟层（emulation layer）和管理层（hypervisor layer），而是使用操作系统的系统调用接口。这降低了运行单个容器所需的开销，也使得宿主机中可以运行更多的容器。</p>
<p>尽管有着光辉的历史，容器仍未得到广泛的认可。一个很重要的原因就是容器技术的复杂性：容器本身就比较复杂，不易安装，管理和自动化也很困难。而Docker就是为了改变这一切而生的。</p>
<h3 id="1-2-2容器与虚拟机比较"><a href="#1-2-2容器与虚拟机比较" class="headerlink" title="1.2.2容器与虚拟机比较"></a>1.2.2容器与虚拟机比较</h3><p>1.本质上的区别</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image7.png" alt="image7"></p>
<p>2.使用上的区别</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image8.png" alt="image8"></p>
<p>虚拟机已死，容器才是未来。</p>
<h3 id="1-2-3-Docker特点"><a href="#1-2-3-Docker特点" class="headerlink" title="1.2.3 Docker特点"></a>1.2.3 Docker特点</h3><p>（1）上手快。</p>
<p>用户只需要几分钟，就可以把自己的程序“Docker化”。Docker依赖于“写时复制”（copy-on-write）模型，使修改应用程序也非常迅速，可以说达到“随心所致，代码即改”的境界。</p>
<p>​    随后，就可以创建容器来运行应用程序了。大多数Docker容器只需要不到1秒中即可启动。由于去除了管理程序的开销，Docker容器拥有很高的性能，同时同一台宿主机中也可以运行更多的容器，使用户尽可能的充分利用系统资源。</p>
<p>（2）职责的逻辑分类</p>
<p>使用Docker，开发人员只需要关心容器中运行的应用程序，而运维人员只需要关心如何管理容器。Docker设计的目的就是要加强开发人员写代码的开发环境与应用程序要部署的生产环境一致性。从而降低那种“开发时一切正常，肯定是运维的问题（测试环境都是正常的，上线后出了问题就归结为肯定是运维的问题）”</p>
<p>（3）快速高效的开发生命周期**</p>
<p>Docker的目标之一就是缩短代码从开发、测试到部署、上线运行的周期，让你的应用程序具备可移植性，易于构建，并易于协作。（通俗一点说，Docker就像一个盒子，里面可以装很多物件，如果需要这些物件的可以直接将该大盒子拿走，而不需要从该盒子中一件件的取。）</p>
<p>（4）鼓励使用面向服务的架构**</p>
<p>Docker还鼓励面向服务的体系结构和微服务架构。Docker推荐单个容器只运行一个应用程序或进程，这样就形成了一个分布式的应用程序模型，在这种模型下，应用程序或者服务都可以表示为一系列内部互联的容器，从而使分布式部署应用程序，扩展或调试应用程序都变得非常简单，同时也提高了程序的内省性。（当然，可以在一个容器中运行多个应用程序）</p>
<h2 id="1-3-Docker组件"><a href="#1-3-Docker组件" class="headerlink" title="1.3 Docker组件"></a>1.3 Docker组件</h2><h3 id="1-3-1-Docker客户端和服务器"><a href="#1-3-1-Docker客户端和服务器" class="headerlink" title="1.3.1 Docker客户端和服务器"></a>1.3.1 Docker客户端和服务器</h3><p>Docker是一个客户端-服务器（C/S）架构程序。Docker客户端只需要向Docker服务器或者守护进程发出请求，服务器或者守护进程将完成所有工作并返回结果。Docker提供了一个命令行工具Docker以及一整套RESTful API。你可以在同一台宿主机上运行Docker守护进程和客户端，也可以从本地的Docker客户端连接到运行在另一台宿主机上的远程Docker守护进程。</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image9.png" alt="image9"></p>
<h3 id="1-3-2-Docker镜像"><a href="#1-3-2-Docker镜像" class="headerlink" title="1.3.2 Docker镜像"></a>1.3.2 Docker镜像</h3><p>镜像是构建Docker的基石。用户基于镜像来运行自己的容器。镜像也是Docker生命周期中的“构建”部分。镜像是基于联合文件系统的一种层式结构，由一系列指令一步一步构建出来。例如：</p>
<p>添加一个文件；</p>
<p>执行一个命令；</p>
<p>打开一个窗口。</p>
<p>也可以将镜像当作容器的“源代码”。镜像体积很小，非常“便携”，易于分享、存储和更新。</p>
<h3 id="1-3-3-Registry（注册中心）"><a href="#1-3-3-Registry（注册中心）" class="headerlink" title="1.3.3 Registry（注册中心）"></a>1.3.3 Registry（注册中心）</h3><p>Docker用Registry来保存用户构建的镜像。Registry分为公共和私有两种。Docker公司运营公共的Registry叫做Docker Hub。用户可以在Docker Hub注册账号，分享并保存自己的镜像（说明：在Docker Hub下载镜像巨慢，可以自己构建私有的Registry）。</p>
<h3 id="1-3-4-Docker容器"><a href="#1-3-4-Docker容器" class="headerlink" title="1.3.4 Docker容器"></a>1.3.4 Docker容器</h3><p>Docker可以帮助你构建和部署容器，你只需要把自己的应用程序或者服务打包放进容器即可。容器是基于镜像启动起来的，容器中可以运行一个或多个进程。我们可以认为，镜像是Docker生命周期中的构建或者打包阶段，而容器则是启动或者执行阶段。  容器基于镜像启动，一旦容器启动完成后，我们就可以登录到容器中安装自己需要的软件或者服务。</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image10.png" alt="image10"></p>
<p>所以Docker容器就是：</p>
<p>一个镜像格式；</p>
<p>一些列标准操作；</p>
<p>一个执行环境。</p>
<p>Docker借鉴了标准集装箱的概念。标准集装箱将货物运往世界各地，Docker将这个模型运用到自己的设计中，唯一不同的是：集装箱运输货物，而Docker运输软件。</p>
<p>​    和集装箱一样，Docker在执行上述操作时，并不关心容器中到底装了什么，它不管是web服务器，还是数据库，或者是应用程序服务器什么的。所有的容器都按照相同的方式将内容“装载”进去。</p>
<p>​    Docker也不关心你要把容器运到何方：我们可以在自己的笔记本中构建容器，上传到Registry，然后下载到一个物理的或者虚拟的服务器来测试，在把容器部署到具体的主机中。像标准集装箱一样，Docker容器方便替换，可以叠加，易于分发，并且尽量通用。</p>
<p>​    使用Docker，我们可以快速的构建一个应用程序服务器、一个消息总线、一套实用工具、一个持续集成（CI）测试环境或者任意一种应用程序、服务或工具。我们可以在本地构建一个完整的测试环境，也可以为生产或开发快速复制一套复杂的应用程序栈。</p>
<h1 id="2-Docker安装与启动"><a href="#2-Docker安装与启动" class="headerlink" title="2.Docker安装与启动"></a>2.Docker安装与启动</h1><h2 id="2-1安装环境说明"><a href="#2-1安装环境说明" class="headerlink" title="2.1安装环境说明"></a>2.1安装环境说明</h2><p>Docker官方建议在Ubuntu中安装，因为Docker是基于Ubuntu发布的，而且一般Docker出现的问题Ubuntu是最先更新或者打补丁的。在很多版本的CentOS中是不支持更新最新的一些补丁包的。</p>
<p>​    由于我们学习的环境都使用的是CentOS，因此这里我们将Docker安装到CentOS上。注意：这里建议安装在CentOS7.x以上的版本，在CentOS6.x的版本中，安装前需要安装其他很多的环境而且Docker很多补丁不支持更新。</p>
<h2 id="2-2在VMware-Workstation中安装CentOS7"><a href="#2-2在VMware-Workstation中安装CentOS7" class="headerlink" title="2.2在VMware Workstation中安装CentOS7"></a>2.2在VMware Workstation中安装CentOS7</h2><p>资料已经准备了安装好的镜像，直接挂载即可。</p>
<p>挂载后，使用ip addr命令查看本地IP</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image11.png" alt="image11"></p>
<h2 id="2-3安装Docker"><a href="#2-3安装Docker" class="headerlink" title="2.3安装Docker"></a>2.3安装Docker</h2><p>使用yum命令在线安装</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install docker</span><br></pre></td></tr></table></figure>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image12.png" alt="image12"></p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image13.png" alt="image13"></p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image14.png" alt="image14"></p>
<h2 id="2-4安装后查看Docker版本"><a href="#2-4安装后查看Docker版本" class="headerlink" title="2.4安装后查看Docker版本"></a>2.4安装后查看Docker版本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker -v</span><br></pre></td></tr></table></figure>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image15.png" alt="image15"></p>
<h2 id="2-5启动与停止Docker"><a href="#2-5启动与停止Docker" class="headerlink" title="2.5启动与停止Docker"></a>2.5启动与停止Docker</h2><p><strong>systemctl</strong>命令是系统服务管理器指令，它是 service 和 chkconfig 两个命令组合。</p>
<ul>
<li>启动docker：systemctl start docker</li>
<li>停止docker：systemctl stop docker</li>
<li>重启docker：systemctl restart docker</li>
<li>查看docker状态：systemctl status docker</li>
<li><p>开机启动：systemctl enable docker</p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image16.png" alt="image16"></p>
</li>
<li><p>查看docker概要信息：docker info</p>
</li>
<li>查看docker帮助文档：docker –help</li>
</ul>
<h1 id="3-Docker镜像操作"><a href="#3-Docker镜像操作" class="headerlink" title="3.Docker镜像操作"></a>3.Docker镜像操作</h1><h2 id="3-1什么是Docker镜像"><a href="#3-1什么是Docker镜像" class="headerlink" title="3.1什么是Docker镜像"></a>3.1什么是Docker镜像</h2><p>Docker镜像是由文件系统叠加而成（是一种文件的存储形式）。最底端是一个文件引导系统，即bootfs，这很像典型的Linux/Unix的引导文件系统。Docker用户几乎永远不会和引导系统有什么交互。实际上，当一个容器启动后，它将会被移动到内存中，而引导文件系统则会被卸载，以留出更多的内存供磁盘镜像使用。Docker容器启动是需要的一些文件，而这些文件就可以称为Docker镜像。</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image17.png" alt="image17"></p>
<h2 id="3-2列出镜像"><a href="#3-2列出镜像" class="headerlink" title="3.2列出镜像"></a>3.2列出镜像</h2><p>列出docker下的所有镜像：docker images</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image18.png" alt="image18"></p>
<ul>
<li>REPOSITORY：镜像所在的仓库名称</li>
<li>TAG：镜像标签</li>
<li>IMAGE ID：镜像ID</li>
<li>CREATED：镜像的创建日期（不是获取该镜像的日期）</li>
<li>SIZE：镜像大小</li>
<li><p>这些镜像都是存储在Docker宿主机的/var/lib/docker目录下</p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image19.png" alt="image19"></p>
</li>
</ul>
<p>为了区分同一个仓库下的不同镜像，Docker提供了一种称为标签（Tag）的功能。每个镜像在列出来时都带有一个标签，例如12.10、12.04等等。每个标签对组成特定镜像的一些镜像层进行标记（比如，标签12.04就是对所有Ubuntu12.04镜像层的标记）。这种机制使得同一个仓库中可以存储多个镜像。— 版本号</p>
<p>​    我们在运行同一个仓库中的不同镜像时，可以通过在仓库名后面加上一个冒号和标签名来指定该仓库中的某一具体的镜像，例如docker run –name custom_container_name –i –t docker.io/ubunto:12.04 /bin/bash，表明从镜像Ubuntu:12.04启动一个容器，而这个镜像的操作系统就是Ubuntu:12.04。在构建容器时指定仓库的标签也是一个好习惯。</p>
<h2 id="3-3搜索镜像"><a href="#3-3搜索镜像" class="headerlink" title="3.3搜索镜像"></a>3.3搜索镜像</h2><p>如果你需要从网络中查找需要的镜像，可以通过以下命令搜索</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search 镜像名称</span><br></pre></td></tr></table></figure>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image20.png" alt="image20"> </p>
<ul>
<li>NAME：仓库名称</li>
<li>DESCRIPTION：镜像描述</li>
<li>STARS：用户评价，反应一个镜像的受欢迎程度</li>
<li>OFFICIAL：是否官方</li>
</ul>
<p>AUTOMATED：自动构建，表示该镜像由Docker Hub自动构建流程创建的</p>
<h2 id="3-4拉取镜像"><a href="#3-4拉取镜像" class="headerlink" title="3.4拉取镜像"></a>3.4拉取镜像</h2><h3 id="3-4-1从Docker-Hub拉取"><a href="#3-4-1从Docker-Hub拉取" class="headerlink" title="3.4.1从Docker Hub拉取"></a>3.4.1从Docker Hub拉取</h3><p>Docker镜像首页，包括官方镜像和其它公开镜像。Docker Hub上最受欢迎的10大镜像（通过Docker registry API获取不了镜像被pull的个数，只能通过镜像的stars数量，来衡量镜像的流行度。毫无疑问，拥有最高stars数量的库都是官方库）。 </p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image21.png" alt="image21"></p>
<p>国情的原因，国内下载 Docker HUB 官方的相关镜像比较慢，可以使用国内（docker.io）的一些镜像加速器，镜像保持和官方一致，关键是速度块，推荐使用。Mirror与Private Registry的区别：</p>
<p>Private Registry（私有仓库）是开发者或者企业自建的镜像存储库，通常用来保存企业内部的 Docker 镜像，用于内部开发流程和产品的发布、版本控制。</p>
<p>Mirror是一种代理中转服务，我们(比如daocloud)提供的Mirror服务，直接对接Docker Hub的官方Registry。Docker Hub 上有数以十万计的各类 Docker 镜像。</p>
<p>在使用Private Registry时，需要在Docker Pull 或Dockerfile中直接键入Private Registry 的地址，通常这样会导致与 Private Registry 的绑定，缺乏灵活性。</p>
<p>使用 Mirror 服务，只需要在 Docker 守护进程（Daemon）的配置文件中加入 Mirror 参数，即可在全局范围内透明的访问官方的 Docker Hub，避免了对 Dockerfile 镜像引用来源的修改。</p>
<p>简单来说，Mirror类似CDN，本质是官方的cache；Private Registry类似私服，跟官方没什么关系。对用户来说，由于用户是要拖docker hub上的image，对应的是Mirror。yum/apt-get的Mirror又有点不一样，它其实是把官方的库文件整个拖到自己的服务器上做镜像，并定时与官方做同步；而Docker Mirror只会缓存曾经使用过的image。</p>
<p>使用命令拉取：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull centos:7</span><br></pre></td></tr></table></figure>
<p>目前国内访问docker hub速度上有点尴尬，使用docker Mirror势在必行。现有国内提供docker镜像加速服务的商家有不少，下面重点ustc镜像。</p>
<h3 id="3-4-2-ustc的镜像"><a href="#3-4-2-ustc的镜像" class="headerlink" title="3.4.2 ustc的镜像"></a>3.4.2 ustc的镜像</h3><p>ustc是老牌的linux镜像服务提供者了，还在遥远的ubuntu 5.04版本的时候就在用。ustc的docker镜像加速器速度很快。ustc docker mirror的优势之一就是不需要注册，是真正的公共服务。</p>
<p><a href="https://lug.ustc.edu.cn/wiki/mirrors/help/docker" target="_blank" rel="noopener">https://lug.ustc.edu.cn/wiki/mirrors/help/docker</a></p>
<p><strong>步骤：</strong></p>
<p>（1）编辑该文件：vi /etc/docker/daemon.json  // 如果该文件不存在就手动创建；说明：在centos7.x下，通过vi。</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image22.png" alt="image22"></p>
<p>（2）在该文件中输入如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;registry-mirrors&quot;: [&quot;https://docker.mirrors.ustc.edu.cn&quot;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（3）注意：一定要重启docker服务，如果重启docker后无法加速，可以重新启动OS</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image23.png" alt="image23"></p>
<p>然后通过docker pull命令下载镜像：速度杠杠的。</p>
<h3 id="3-5删除镜像"><a href="#3-5删除镜像" class="headerlink" title="3.5删除镜像"></a>3.5删除镜像</h3><ol>
<li>docker rmi $IMAGE_ID：删除指定镜像</li>
<li><p>docker rmi <code>docker images -q</code>：删除所有镜像</p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image24.png" alt="image24"></p>
</li>
</ol>
<h1 id="4-Docker容器操作"><a href="#4-Docker容器操作" class="headerlink" title="4.Docker容器操作"></a>4.Docker容器操作</h1><h2 id="4-1查看容器"><a href="#4-1查看容器" class="headerlink" title="4.1查看容器"></a>4.1查看容器</h2><ul>
<li><p>查看正在运行容器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看所有的容器（启动过的历史容器）：</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps –a</span><br></pre></td></tr></table></figure>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image25.png" alt="image25"></p>
<ul>
<li>查看最后一次运行的容器：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps –l</span><br></pre></td></tr></table></figure>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image26.png" alt="image26"></p>
<ul>
<li>查看停止的容器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -f status=exited</span><br></pre></td></tr></table></figure>
<h2 id="4-2创建与启动容器"><a href="#4-2创建与启动容器" class="headerlink" title="4.2创建与启动容器"></a>4.2创建与启动容器</h2><ul>
<li>创建容器常用的参数说明：</li>
<li>创建容器命令：docker run</li>
<li>-i：表示运行容器</li>
<li>-t：表示容器启动后会进入其命令行。加入这两个参数后，容器创建就能登录进去。即分配一个伪终端。</li>
<li>–name :为创建的容器命名。</li>
<li>-v：表示目录映射关系（前者是宿主机目录，后者是映射到宿主机上的目录），可以使用多个－v做多个目录或文件映射。注意：最好做目录映射，在宿主机上做修改，然后共享到容器上。</li>
<li>-d：在run后面加上-d参数,则会创建一个守护式容器在后台运行（这样创建容器后不会自动登录容器，如果只加-i -t两个参数，创建后就会自动进去容器）。</li>
<li>-p：表示端口映射，前者是宿主机端口，后者是容器内的映射端口。可以使用多个－p做多个端口映射</li>
</ul>
<h3 id="4-1-1交互式容器"><a href="#4-1-1交互式容器" class="headerlink" title="4.1.1交互式容器"></a>4.1.1交互式容器</h3><p>创建一个交互式容器并取名为mycentos</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name=mycentos centos:7 /bin/bash</span><br></pre></td></tr></table></figure>
<p>这时我们通过ps命令查看，发现可以看到启动的容器，状态为启动状态</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image27.png" alt="image27"></p>
<p>使用exit命令 退出当前容器</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image28.png" alt="image28"></p>
<p>然后用ps -a 命令查看发现该容器也随之停止：</p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image29.png" alt="image29"></p>
<h3 id="4-1-2守护式容器"><a href="#4-1-2守护式容器" class="headerlink" title="4.1.2守护式容器"></a>4.1.2守护式容器</h3><p>创建一个守护式容器：如果对于一个需要长期运行的容器来说，我们可以创建一个守护式容器。命令如下（容器名称不能重复）：</p>
<ul>
<li>登录守护式容器方式：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -di --name=mycentos2 centos:7</span><br></pre></td></tr></table></figure>
<p>docker exec -it container_name (或者 container_id)  /bin/bash（exit退出时，容器不会停止）</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image30.png" alt="image30"></p>
<h2 id="4-3停止与启动容器"><a href="#4-3停止与启动容器" class="headerlink" title="4.3停止与启动容器"></a>4.3停止与启动容器</h2><ul>
<li><p>停止正在运行的容器：docker stop $CONTAINER_NAME/ID</p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image31.png" alt="image31"></p>
</li>
<li><p>启动已运行过的容器：docker start $CONTAINER_NAME/ID</p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image32.png" alt="image32"></p>
</li>
</ul>
<h2 id="4-4文件拷贝"><a href="#4-4文件拷贝" class="headerlink" title="4.4文件拷贝"></a>4.4文件拷贝</h2><p>如果我们需要将文件拷贝到容器内可以使用cp命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp 需要拷贝的文件或目录 容器名称:容器目录</span><br></pre></td></tr></table></figure>
<p>也可以将文件从容器内拷贝出来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp 容器名称:容器目录 需要拷贝的文件或目录</span><br></pre></td></tr></table></figure>
<h2 id="4-5目录挂载"><a href="#4-5目录挂载" class="headerlink" title="4.5目录挂载"></a>4.5目录挂载</h2><p>我们可以在创建容器的时候，将宿主机的目录与容器内的目录进行映射，这样我们就可以通过修改宿主机某个目录的文件从而去影响容器。</p>
<p>创建容器 添加-v参数 后边为   宿主机目录:容器目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -di -v /usr/local/myhtml:/usr/local/myhtml --name=mycentos2 centos:7</span><br></pre></td></tr></table></figure>
<p>如果你共享的是多级的目录，可能会出现权限不足的提示。</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image33.png" alt="image33"></p>
<p>这是因为CentOS7中的安全模块selinux把权限禁掉了，我们需要添加参数  –privileged=true  来解决挂载的目录没有权限的问题</p>
<h2 id="4-6查看容器IP地址"><a href="#4-6查看容器IP地址" class="headerlink" title="4.6查看容器IP地址"></a>4.6查看容器IP地址</h2><p>我们可以通过以下命令查看容器运行的各种数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect mycentos2</span><br></pre></td></tr></table></figure>
<p>也可以直接执行下面的命令直接输出IP地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect --format=&apos;&#123;&#123;.NetworkSettings.IPAddress&#125;&#125;&apos; mycentos2</span><br></pre></td></tr></table></figure>
<h2 id="4-7删除容器"><a href="#4-7删除容器" class="headerlink" title="4.7删除容器"></a>4.7删除容器</h2><ul>
<li><p>删除指定的容器：docker rm $CONTAINER_ID/NAME</p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image34.png" alt="image34"></p>
</li>
</ul>
<p>注意，只能删除停止的容器</p>
<ul>
<li><p>删除所有容器：docker rm <code>docker ps -a -q</code></p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image35.png" alt="image35"></p>
</li>
</ul>
<h1 id="5-部署应用"><a href="#5-部署应用" class="headerlink" title="5.部署应用"></a>5.部署应用</h1><h2 id="5-1-MySQL部署"><a href="#5-1-MySQL部署" class="headerlink" title="5.1 MySQL部署"></a>5.1 MySQL部署</h2><h3 id="5-1-1拉取MySQL镜像"><a href="#5-1-1拉取MySQL镜像" class="headerlink" title="5.1.1拉取MySQL镜像"></a>5.1.1拉取MySQL镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql</span><br></pre></td></tr></table></figure>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image36.png" alt="image36"></p>
<p>查看镜像</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image37.png" alt="image37"></p>
<h3 id="5-1-2创建MySQL容器"><a href="#5-1-2创建MySQL容器" class="headerlink" title="5.1.2创建MySQL容器"></a>5.1.2创建MySQL容器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -di --name pinyougou_mysql -p 33306:3306 -e MYSQL_ROOT_PASSWORD=123456 mysql</span><br></pre></td></tr></table></figure>
<p>-p 代表端口映射，格式为  宿主机映射端口:容器运行端口</p>
<p>-e 代表添加环境变量  MYSQL_ROOT_PASSWORD是root用户的登陆密码</p>
<h3 id="5-1-3进入MySQL容器-登陆MySQL"><a href="#5-1-3进入MySQL容器-登陆MySQL" class="headerlink" title="5.1.3进入MySQL容器,登陆MySQL"></a>5.1.3进入MySQL容器,登陆MySQL</h3><p>进入mysql容器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it pinyougou_mysql /bin/bash</span><br></pre></td></tr></table></figure>
<p>登陆mysql</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure>
<h3 id="5-1-4远程登陆MySQL"><a href="#5-1-4远程登陆MySQL" class="headerlink" title="5.1.4远程登陆MySQL"></a>5.1.4远程登陆MySQL</h3><p>我们在我们本机的电脑上去连接虚拟机Centos中的Docker容器，这里192.168.247.130是虚拟机操作系统的IP</p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image38.png" alt="image38"></p>
<h3 id="5-1-5查看容器IP地址"><a href="#5-1-5查看容器IP地址" class="headerlink" title="5.1.5查看容器IP地址"></a>5.1.5查看容器IP地址</h3><p>我们可以通过以下命令查看容器运行的各种数据</p>
<p>运行效果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect pinyougou_mysql</span><br></pre></td></tr></table></figure>
<p>我们可以看到我们的数据库服务器的IP是172.17.0.2 </p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image40.png" alt="image40"></p>
<h2 id="5-2-tomcat部署"><a href="#5-2-tomcat部署" class="headerlink" title="5.2 tomcat部署"></a>5.2 tomcat部署</h2><h3 id="5-2-1拉取tomcat镜像"><a href="#5-2-1拉取tomcat镜像" class="headerlink" title="5.2.1拉取tomcat镜像"></a>5.2.1拉取tomcat镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull tomcat:7-jre7</span><br></pre></td></tr></table></figure>
<h3 id="5-2-2创建tomca容器"><a href="#5-2-2创建tomca容器" class="headerlink" title="5.2.2创建tomca容器"></a>5.2.2创建tomca容器</h3><p>创建容器用于部署单点登录系统（CAS）  -p表示地址映射</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -di --name=pinyougou_tomcat -p 9000:8080 </span><br><span class="line">-v /usr/local/myhtml:/usr/local/tomcat/webapps --privileged=true tomcat:7-jre7</span><br></pre></td></tr></table></figure>
<h3 id="5-2-3部署web应用"><a href="#5-2-3部署web应用" class="headerlink" title="5.2.3部署web应用"></a>5.2.3部署web应用</h3><p>（1）修改cas系统的配置文件，修改数据库连接的url </p>
<p>测试：地址栏输入：<a href="http://192.168.247.135:9000/cas/login" target="_blank" rel="noopener">http://192.168.247.135:9000/cas/login</a> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"</span><br><span class="line">		p:driverClass=<span class="string">"com.mysql.jdbc.Driver"</span></span><br><span class="line">		p:jdbcUrl=<span class="string">"jdbc:mysql://172.17.0.6:3306/pinyougoudb?characterEncoding=utf8"</span></span><br><span class="line">		p:user=<span class="string">"root"</span></span><br><span class="line">		p:password=<span class="string">"123456"</span> /&gt;</span><br></pre></td></tr></table></figure>
<h2 id="5-3-Nginx部署"><a href="#5-3-Nginx部署" class="headerlink" title="5.3 Nginx部署"></a>5.3 Nginx部署</h2><h3 id="5-3-1拉取Nginx镜像"><a href="#5-3-1拉取Nginx镜像" class="headerlink" title="5.3.1拉取Nginx镜像"></a>5.3.1拉取Nginx镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull nginx</span><br></pre></td></tr></table></figure>
<h3 id="5-3-2创建Nginx容器"><a href="#5-3-2创建Nginx容器" class="headerlink" title="5.3.2创建Nginx容器"></a>5.3.2创建Nginx容器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -di --name=pinyougou_nginx -p 80:80  nginx/bin/bash</span><br></pre></td></tr></table></figure>
<h3 id="5-3-3测试Nginx"><a href="#5-3-3测试Nginx" class="headerlink" title="5.3.3测试Nginx"></a>5.3.3测试Nginx</h3><p>浏览器地址栏输入： <a href="http://192.168.247.135" target="_blank" rel="noopener">http://192.168.247.135</a> </p>
<p> <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/docker/image42.png" alt="image42"></p>
<h3 id="5-3-4配置反向代理"><a href="#5-3-4配置反向代理" class="headerlink" title="5.3.4配置反向代理"></a>5.3.4配置反向代理</h3><p>官方的nginx镜像,nginx配置文件nginx.conf 在/etc/nginx/目录下。</p>
<p>在容器内编辑配置文件不方便，我们可以先将配置文件从容器内拷贝到宿主机，编辑修改后再拷贝回去。</p>
<p>（1）从容器拷贝配置文件到宿主机</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp pinyougou_nginx:/etc/nginx/nginx.conf nginx.conf</span><br></pre></td></tr></table></figure>
<p>（2）编辑nginx.conf，添加反向代理配置</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">upstream tomcat-cas &#123;</span><br><span class="line">	server <span class="number">172.17</span><span class="number">.0</span><span class="number">.7</span>:<span class="number">8080</span>;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">	listen <span class="number">80</span>;</span><br><span class="line">	server_name passport.pinyougou.com;</span><br><span class="line">	location / &#123;</span><br><span class="line">		proxy_pass http://tomcat-cas;</span><br><span class="line">		index index.html index.htm;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（3）将修改后的配置文件拷贝到容器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp nginx.conf  pinyougou_nginx:/etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure>
<p>（4）重新启动容器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart pinyougou_nginx</span><br></pre></td></tr></table></figure>
<p>（5）设置域名指向</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.247.135 passport.pinyougou.com</span><br></pre></td></tr></table></figure>
<p>浏览器测试：<a href="http://passport.pinyougou.com/cas/login" target="_blank" rel="noopener">http://passport.pinyougou.com/cas/login</a></p>
<h2 id="5-4-Redis部署"><a href="#5-4-Redis部署" class="headerlink" title="5.4 Redis部署"></a>5.4 Redis部署</h2><h3 id="5-4-1拉取Redis镜像"><a href="#5-4-1拉取Redis镜像" class="headerlink" title="5.4.1拉取Redis镜像"></a>5.4.1拉取Redis镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull redis</span><br></pre></td></tr></table></figure>
<h3 id="5-4-2创建Redis容器"><a href="#5-4-2创建Redis容器" class="headerlink" title="5.4.2创建Redis容器"></a>5.4.2创建Redis容器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -di --name=pinyougou_redis -p 6379:6379 redis</span><br></pre></td></tr></table></figure>
<h3 id="5-4-3客户端测试"><a href="#5-4-3客户端测试" class="headerlink" title="5.4.3客户端测试"></a>5.4.3客户端测试</h3><p>在你的本地电脑命令提示符下，用window版本redis测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h 192.168.247.135</span><br></pre></td></tr></table></figure>
<h1 id="6-备份与迁移"><a href="#6-备份与迁移" class="headerlink" title="6.备份与迁移"></a>6.备份与迁移</h1><h2 id="6-1容器保存为镜像"><a href="#6-1容器保存为镜像" class="headerlink" title="6.1容器保存为镜像"></a>6.1容器保存为镜像</h2><p>我们可以通过以下命令将容器保存为镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker commit pinyougou_nginx mynginx</span><br></pre></td></tr></table></figure>
<p>pinyougou_nginx是容器名称</p>
<p>mynginx是新的镜像名称</p>
<p>此镜像的内容就是你当前容器的内容，接下来你可以用此镜像再次运行新的容器</p>
<h2 id="6-2镜像备份"><a href="#6-2镜像备份" class="headerlink" title="6.2镜像备份"></a>6.2镜像备份</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker  save -o mynginx.tar mynginx</span><br></pre></td></tr></table></figure>
<p>-o 输出到的文件</p>
<p>执行后，运行ls命令即可看到打成的tar包</p>
<h2 id="6-3镜像恢复与迁移"><a href="#6-3镜像恢复与迁移" class="headerlink" title="6.3镜像恢复与迁移"></a>6.3镜像恢复与迁移</h2><p>首先我们先删除掉mynginx镜像</p>
<p>然后执行此命令进行恢复</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker load -i mynginx.tar</span><br></pre></td></tr></table></figure>
<p>-i 输入的文件</p>
<p>执行后再次查看镜像，可以看到镜像已经恢复</p>
 

	    
</div>

<div class="center">
			

				<span class="post-meta">		
				<span class="iconfont icon-category"></span>
				<a class="category-link" href="/categories/docker/">docker</a>
				</span>
		
			

		
				
				<span class="post-meta">
				<span class="iconfont icon-tag"></span>
				<a class="tag-link" href="/tags/docker/">docker</a>
				</span>			
			


		

		<span class="post-words"><span class="iconfont icon-words"></span>
		10683
		</span>		
</div>		

		
    <a class="article-readmore" href="/2017/12/15/容器部署Docker入门/">阅读更多</a> 
    	
</article>     
     	
      	  	

  		
    	<article class="article">		
	   
	<div class="article-header">
	    
	     <a class="article-title"  href="/2017/12/14/Hadoop集群的搭建/">Hadoop集群的搭建</a>  
	       
		 

		 <time>2017-12-14 </time>    
	</div>


    <div class="article-excerpt">	
	
  	

	  

	  	<h1 id="1-准备Linux环境"><a href="#1-准备Linux环境" class="headerlink" title="1.准备Linux环境"></a>1.准备Linux环境</h1><p>​    </p>
<h2 id="1-1修改各个虚拟机主机名"><a href="#1-1修改各个虚拟机主机名" class="headerlink" title="1.1修改各个虚拟机主机名"></a>1.1修改各个虚拟机主机名</h2><pre><code>vi /etc/sysconfig/network

NETWORKING=yes
HOSTNAME=node-1    
</code></pre><h2 id="1-2修改主机名和IP的映射关系"><a href="#1-2修改主机名和IP的映射关系" class="headerlink" title="1.2修改主机名和IP的映射关系"></a>1.2修改主机名和IP的映射关系</h2><pre><code>vi /etc/hosts

192.168.1.101    node-1
192.168.1.102    node-2
192.168.1.103    node-3
</code></pre><h2 id="1-3关闭防火墙"><a href="#1-3关闭防火墙" class="headerlink" title="1.3关闭防火墙"></a>1.3关闭防火墙</h2><pre><code>#查看防火墙状态
service iptables status
#关闭防火墙
service iptables stop
#查看防火墙开机启动状态
chkconfig iptables --list
#关闭防火墙开机启动
chkconfig iptables off
</code></pre><h2 id="1-4-配置ssh免登陆"><a href="#1-4-配置ssh免登陆" class="headerlink" title="1.4.配置ssh免登陆"></a>1.4.配置ssh免登陆</h2><p>生成ssh免登陆密钥</p>
<p>ssh-keygen -t rsa （四个回车）</p>
<p>执行完这个命令后，会生成两个文件id_rsa（私钥）、id_rsa.pub（公钥）<br>将公钥拷贝到要免密登陆的目标机器上</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id node-2</span><br></pre></td></tr></table></figure>
<h2 id="1-5-同步集群时间"><a href="#1-5-同步集群时间" class="headerlink" title="1.5 同步集群时间"></a>1.5 同步集群时间</h2><p>常用的手动进行时间的同步</p>
<pre><code>date -s &quot;2017-03-03 03:03:03&quot;
</code></pre><p>或者网络同步：<br>    yum install ntpdate</p>
<pre><code>ntpdate cn.pool.ntp.org
</code></pre><hr>
<h1 id="2-安装JDK"><a href="#2-安装JDK" class="headerlink" title="2.安装JDK"></a>2.安装JDK</h1><h2 id="2-1上传jdk"><a href="#2-1上传jdk" class="headerlink" title="2.1上传jdk"></a>2.1上传jdk</h2><pre><code>rz jdk-8u65-linux-x64.tar.gz
</code></pre><h2 id="2-2解压jdk"><a href="#2-2解压jdk" class="headerlink" title="2.2解压jdk"></a>2.2解压jdk</h2><pre><code>tar -zxvf jdk-8u65-linux-x64.tar.gz -C /root/apps
</code></pre><h2 id="2-3将java添加到环境变量中"><a href="#2-3将java添加到环境变量中" class="headerlink" title="2.3将java添加到环境变量中"></a>2.3将java添加到环境变量中</h2><pre><code>vim /etc/profile
#在文件最后添加
export JAVA_HOME=/root/apps/jdk1.8.0_65
export PATH=$PATH:$JAVA_HOME/bin
export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar

#刷新配置
source /etc/profile
</code></pre><hr>
<h1 id="3-安装hadoop2-7-4"><a href="#3-安装hadoop2-7-4" class="headerlink" title="3.安装hadoop2.7.4"></a>3.安装hadoop2.7.4</h1><pre><code>hadoop-2.7.4-with-centos-6.7.tar.gz
解压安装包
tar zxvf hadoop-2.7.4-with-centos-6.7.tar.gz
</code></pre><p>注意：1.hadoop2.x的配置文件目录：$HADOOP_HOME/etc/hadoop</p>
<p>​       2.生产环境下需要根据生产机器重新编译Hadoop:<a href="https://minrui.red/2017/12/11/hadoop%E7%BC%96%E8%AF%91/" target="_blank" rel="noopener">https://minrui.red/2017/12/11/hadoop%E7%BC%96%E8%AF%91/</a></p>
<h2 id="3-1配置hadoop"><a href="#3-1配置hadoop" class="headerlink" title="3.1配置hadoop"></a>3.1配置hadoop</h2><p>第一个：hadoop-env.sh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi hadoop-env.sh</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/root/apps/jdk1.8.0_65</span><br></pre></td></tr></table></figure>
<p>第二个：core-site.xml</p>
<pre><code> &lt;!-- 指定HADOOP所使用的文件系统schema（URI），HDFS的老大（NameNode）的地址 --&gt;
&lt;property&gt;
        &lt;name&gt;fs.defaultFS&lt;/name&gt;
        &lt;value&gt;hdfs://master:9000&lt;/value&gt;
　　　　 &lt;description&gt; 设定 namenode 的 主机名 及 端口 &lt;/description&gt;
&lt;/property&gt;
&lt;!-- 指定hadoop运行时产生文件的存储目录,默认/tmp/hadoop-${user.name} --&gt;
&lt;property&gt;
   &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
   &lt;value&gt;/home/hadoop/hadoop-2.4.1/tmp&lt;/value&gt;
&lt;/property&gt;
</code></pre><p>第三个：hdfs-site.xml   </p>
<pre><code>&lt;!-- 指定HDFS副本的数量 --&gt;
&lt;property&gt;
  &lt;name&gt;dfs.replication&lt;/name&gt;
  &lt;value&gt;2&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
     &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;
      &lt;value&gt;node-22:50090&lt;/value&gt;
&lt;/property&gt;
</code></pre><hr>
<p>第四个：mapred-site.xml<br>​<br>mv mapred-site.xml.template mapred-site.xml<br>vi mapred-site.xml</p>
<pre><code>&lt;!-- 指定mr运行时框架，这里指定在yarn上，默认是local --&gt;
&lt;property&gt;
  &lt;name&gt;mapreduce.framework.name&lt;/name&gt;
  &lt;value&gt;yarn&lt;/value&gt;
&lt;/property&gt;
</code></pre><p>第五个：yarn-site.xml</p>
<pre><code>&lt;!-- 指定YARN的老大（ResourceManager）的地址 --&gt;
&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;
  &lt;value&gt;node-1&lt;/value&gt;
&lt;/property&gt;
&lt;!-- NodeManager上运行的附属服务。需配置成mapreduce_shuffle，才可运行MapReduce程序默认值：&quot;&quot; --&gt;
&lt;property&gt;
  &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
  &lt;value&gt;mapreduce_shuffle&lt;/value&gt;
&lt;/property&gt;
</code></pre><p>第六个：slaves文件，里面写上从节点所在的主机名字vi slaves</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">node-1</span><br><span class="line">node-2</span><br><span class="line">node-3</span><br></pre></td></tr></table></figure>
<p>3.2将hadoop添加到环境变量<br>​    vim /etc/proflie<br>        export JAVA_HOME=/root/apps/jdk1.8.0_65<br>        export HADOOP_HOME=/root/apps/hadoop-2.7.4<br>        export PATH=$PATH:$JAVA_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin</p>
<p>source /etc/profile</p>
<hr>
<pre><code>3.3格式化namenode（本质是对namenode进行初始化）
    hdfs namenode -format (hadoop namenode -format)

3.4启动hadoop
    先启动HDFS
    sbin/start-dfs.sh

    再启动YARN
    sbin/start-yarn.sh

3.5验证是否启动成功
    使用jps命令验证
    27408 NameNode
    28218 Jps
    27643 SecondaryNameNode   (secondarynamenode)
    28066 NodeManager
    27803 ResourceManager
    27512 DataNode

    http://192.168.1.101:50070 （HDFS管理界面）
    http://192.168.1.101:8088 （MR管理界面）
</code></pre><p>​<br>启动后如果没异常，使用jps查看服务<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/jps1.png" alt="jps1"><br>如果没问题，去浏览器查看web页面<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/hadoop-web.png" alt="hadoop-web"></p>
 

	    
</div>

<div class="center">
			

				<span class="post-meta">		
				<span class="iconfont icon-category"></span>
				<a class="category-link" href="/categories/大数据/">大数据</a>
				</span>
		
			

		
				
				<span class="post-meta">
				<span class="iconfont icon-tag"></span>
				<a class="tag-link" href="/tags/Hadoop/">Hadoop</a> <a class="tag-link" href="/tags/集群搭建/">集群搭建</a>
				</span>			
			


		

		<span class="post-words"><span class="iconfont icon-words"></span>
		3190
		</span>		
</div>		

		
    <a class="article-readmore" href="/2017/12/14/Hadoop集群的搭建/">阅读更多</a> 
    	
</article>     
     	
      	  	

  		
    	<article class="article">		
	   
	<div class="article-header">
	    
	     <a class="article-title"  href="/2017/12/14/Spring Boot应用启动器/">Spring Boot应用启动器</a>  
	       
		 

		 <time>2017-12-14 </time>    
	</div>


    <div class="article-excerpt">	
	
  	

	  

	  	<h1 id="Spring-Boot应用启动器"><a href="#Spring-Boot应用启动器" class="headerlink" title="Spring Boot应用启动器"></a>Spring Boot应用启动器</h1><h2 id="spring-Boot应用启动器基本的一共有44种，具体如下："><a href="#spring-Boot应用启动器基本的一共有44种，具体如下：" class="headerlink" title="spring Boot应用启动器基本的一共有44种，具体如下："></a>spring Boot应用启动器基本的一共有44种，具体如下：</h2><p>1）spring-boot-starter<br>这是Spring Boot的核心启动器，包含了自动配置、日志和YAML。</p>
<p>2）spring-boot-starter-actuator<br>帮助监控和管理应用。</p>
<p>3）spring-boot-starter-amqp<br>通过spring-rabbit来支持AMQP协议（Advanced Message Queuing Protocol）。</p>
<p>4）spring-boot-starter-aop<br>支持面向方面的编程即AOP，包括spring-aop和AspectJ。</p>
<p>5）spring-boot-starter-artemis<br>通过Apache Artemis支持JMS的API（<a href="http://lib.csdn.net/base/java" target="_blank" rel="noopener">Java </a>Message Service API）。</p>
<p>6）spring-boot-starter-batch<br>支持Spring Batch，包括HSQLDB<a href="http://lib.csdn.net/base/mysql" target="_blank" rel="noopener">数据库</a>。</p>
<p>7）spring-boot-starter-cache<br>支持Spring的Cache抽象。</p>
<p>8）spring-boot-starter-cloud-connectors<br>支持Spring Cloud Connectors，简化了在像Cloud Foundry或Heroku这样的云平台上连接服务。</p>
<p>9）spring-boot-starter-data-elasticsearch<br>支持ElasticSearch搜索和分析引擎，包括spring-data-elasticsearch。</p>
<p>10）spring-boot-starter-data-gemfire<br>支持GemFire分布式数据存储，包括spring-data-gemfire。</p>
<p>11）spring-boot-starter-data-jpa<br>支持JPA（<a href="http://lib.csdn.net/base/javase" target="_blank" rel="noopener">Java</a> Persistence API），包括spring-data-jpa、spring-orm、<a href="http://lib.csdn.net/base/javaee" target="_blank" rel="noopener">hibernate</a>。</p>
<p>12）spring-boot-starter-data-<a href="http://lib.csdn.net/base/mongodb" target="_blank" rel="noopener">MongoDB</a><br>支持MongoDB数据，包括spring-data-mongodb。</p>
<p>13）spring-boot-starter-data-rest<br>通过spring-data-rest-webmvc，支持通过REST暴露Spring Data数据仓库。</p>
<p>14）spring-boot-starter-data-solr<br>支持Apache Solr搜索平台，包括spring-data-solr。</p>
<p>15）spring-boot-starter-freemarker<br>支持FreeMarker模板引擎。</p>
<p>16）spring-boot-starter-groovy-templates<br>支持Groovy模板引擎。</p>
<p>17）spring-boot-starter-hateoas<br>通过spring-hateoas支持基于HATEOAS的RESTful Web服务。</p>
<p>18）spring-boot-starter-hornetq<br>通过HornetQ支持JMS。</p>
<p>19）spring-boot-starter-integration<br>支持通用的spring-integration模块。</p>
<p>20）spring-boot-starter-jdbc<br>支持JDBC数据库。</p>
<p>21）spring-boot-starter-jersey<br>支持Jersey RESTful Web服务框架。</p>
<p>22）spring-boot-starter-jta-atomikos<br>通过Atomikos支持JTA分布式事务处理。</p>
<p>23）spring-boot-starter-jta-bitronix<br>通过Bitronix支持JTA分布式事务处理。</p>
<p>24）spring-boot-starter-mail<br>支持javax.mail模块。</p>
<p>25）spring-boot-starter-mobile<br>支持spring-mobile。</p>
<p>26）spring-boot-starter-mustache<br>支持Mustache模板引擎。</p>
<p>27）spring-boot-starter-<a href="http://lib.csdn.net/base/redis" target="_blank" rel="noopener">Redis</a><br>支持Redis键值存储数据库，包括spring-redis。</p>
<p>28）spring-boot-starter-security<br>支持spring-security。</p>
<p>29）spring-boot-starter-social-facebook<br>支持spring-social-facebook</p>
<p>30）spring-boot-starter-social-linkedin<br>支持pring-social-linkedin</p>
<p>31）spring-boot-starter-social-twitter<br>支持pring-social-twitter</p>
<p>32）spring-boot-starter-test<br>支持常规的<a href="http://lib.csdn.net/base/softwaretest" target="_blank" rel="noopener">测试</a>依赖，包括JUnit、Hamcrest、Mockito以及spring-test模块。</p>
<p>33）spring-boot-starter-thymeleaf<br>支持Thymeleaf模板引擎，包括与Spring的集成。</p>
<p>34）spring-boot-starter-velocity<br>支持Velocity模板引擎。</p>
<p>35）spring-boot-starter-web<br>S支持全栈式Web开发，包括Tomcat和spring-webmvc。</p>
<p>36）spring-boot-starter-websocket<br>支持WebSocket开发。</p>
<p>37）spring-boot-starter-ws<br>支持Spring Web Services。</p>
<h2 id="Spring-Boot应用启动器面向生产环境的还有2种，具体如下："><a href="#Spring-Boot应用启动器面向生产环境的还有2种，具体如下：" class="headerlink" title="Spring Boot应用启动器面向生产环境的还有2种，具体如下："></a>Spring Boot应用启动器面向生产环境的还有2种，具体如下：</h2><p>1）spring-boot-starter-actuator<br>增加了面向产品上线相关的功能，比如测量和监控。</p>
<p>2）spring-boot-starter-remote-shell<br>增加了远程ssh shell的支持。</p>
<h2 id="Spring-Boot应用启动器还有一些替换技术的启动器，具体如下："><a href="#Spring-Boot应用启动器还有一些替换技术的启动器，具体如下：" class="headerlink" title="Spring Boot应用启动器还有一些替换技术的启动器，具体如下："></a>Spring Boot应用启动器还有一些替换技术的启动器，具体如下：</h2><p>1）spring-boot-starter-jetty<br>引入了Jetty HTTP引擎（用于替换Tomcat）。</p>
<p>2）spring-boot-starter-log4j<br>支持Log4J日志框架。</p>
<p>3）spring-boot-starter-logging<br>引入了Spring Boot默认的日志框架Logback。</p>
<p>4）spring-boot-starter-tomcat<br>引入了Spring Boot默认的HTTP引擎Tomcat。</p>
<p>5）spring-boot-starter-undertow<br>引入了Undertow HTTP引擎（用于替换Tomcat）。</p>
 

	    
</div>

<div class="center">
			

				<span class="post-meta">		
				<span class="iconfont icon-category"></span>
				<a class="category-link" href="/categories/springBoot/">springBoot</a>
				</span>
		
			

		
				
				<span class="post-meta">
				<span class="iconfont icon-tag"></span>
				<a class="tag-link" href="/tags/springBoot/">springBoot</a>
				</span>			
			


		

		<span class="post-words"><span class="iconfont icon-words"></span>
		2759
		</span>		
</div>		

		
    <a class="article-readmore" href="/2017/12/14/Spring Boot应用启动器/">阅读更多</a> 
    	
</article>     
     	
      	  	

  		
    	<article class="article">		
	   
	<div class="article-header">
	    
	     <a class="article-title"  href="/2017/12/14/Spring Boot 配置文件application/">Spring Boot配置文件application</a>  
	       
		 

		 <time>2017-12-14 </time>    
	</div>


    <div class="article-excerpt">	
	
  	

	  

	  	<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br></pre></td><td class="code"><pre><span class="line">#########COMMON SPRING BOOT PROPERTIES</span><br><span class="line">######========CORE PROPERTIES===========</span><br><span class="line">#SPRING CONFIG (ConfigFileApplicationListener)</span><br><span class="line"></span><br><span class="line">spring.config.name= # config file name (default to 'application')</span><br><span class="line">spring.config.location= # location of config file</span><br><span class="line"></span><br><span class="line">#PROFILES</span><br><span class="line">spring.profiles= # comma list of active profiles</span><br><span class="line"></span><br><span class="line">#APPLICATION SETTINGS (SpringApplication)</span><br><span class="line">spring.main.sources=</span><br><span class="line">spring.main.web-environment= # detect by default</span><br><span class="line">spring.main.show-banner=true</span><br><span class="line">spring.main....= # see class for all properties</span><br><span class="line"></span><br><span class="line">#LOGGING</span><br><span class="line">logging.path=/var/logs</span><br><span class="line">logging.file=myapp.log</span><br><span class="line">logging.config=</span><br><span class="line"></span><br><span class="line">#IDENTITY (ContextIdApplicationContextInitializer)</span><br><span class="line">spring.application.name=</span><br><span class="line">spring.application.index=</span><br><span class="line"></span><br><span class="line">#EMBEDDED SERVER CONFIGURATION (ServerProperties)</span><br><span class="line">server.port=8080</span><br><span class="line">server.address= # bind to a specific NIC</span><br><span class="line">server.session-timeout= # session timeout in seconds</span><br><span class="line">server.context-path= # the context path, defaults to '/'</span><br><span class="line">server.servlet-path= # the servlet path, defaults to '/'</span><br><span class="line">server.tomcat.access-log-pattern= # log pattern of the access log</span><br><span class="line">server.tomcat.access-log-enabled=false # is access logging enabled</span><br><span class="line">server.tomcat.protocol-header=x-forwarded-proto # ssl forward headers</span><br><span class="line">server.tomcat.remote-ip-header=x-forwarded-for</span><br><span class="line">server.tomcat.basedir=/tmp # base dir (usually not needed, defaults to tmp)</span><br><span class="line">server.tomcat.background-processor-delay=30; # in seconds</span><br><span class="line">server.tomcat.max-threads = 0 # number of threads in protocol handler</span><br><span class="line">server.tomcat.uri-encoding = UTF-8 # character encoding to use for URL decoding</span><br><span class="line"></span><br><span class="line">#SPRING MVC (HttpMapperProperties)</span><br><span class="line">http.mappers.json-pretty-print=false # pretty print JSON</span><br><span class="line">http.mappers.json-sort-keys=false # sort keys</span><br><span class="line">spring.mvc.locale= # set fixed locale, e.g. enUK</span><br><span class="line">spring.mvc.date-format= # set fixed date format, e.g. dd/MM/yyyy</span><br><span class="line">spring.mvc.message-codes-resolver-format= # PREFIXERRORCODE / POSTFIXERROR_CODE</span><br><span class="line">spring.view.prefix= # MVC view prefix</span><br><span class="line">spring.view.suffix= # ... and suffix</span><br><span class="line">spring.resources.cache-period= # cache timeouts in headers sent to browser</span><br><span class="line">spring.resources.add-mappings=true # if default mappings should be added</span><br><span class="line"></span><br><span class="line">#THYMELEAF (ThymeleafAutoConfiguration)</span><br><span class="line">spring.thymeleaf.prefix=classpath:/templates/</span><br><span class="line">spring.thymeleaf.suffix=.html</span><br><span class="line">spring.thymeleaf.mode=HTML5</span><br><span class="line">spring.thymeleaf.encoding=UTF-8</span><br><span class="line">spring.thymeleaf.content-type=text/html # ;charset=<span class="tag">&lt;<span class="name">encoding</span>&gt;</span> is added</span><br><span class="line">spring.thymeleaf.cache=true # set to false for hot refresh</span><br><span class="line"></span><br><span class="line">#FREEMARKER (FreeMarkerAutoConfiguration)</span><br><span class="line">spring.freemarker.allowRequestOverride=false</span><br><span class="line">spring.freemarker.allowSessionOverride=false</span><br><span class="line">spring.freemarker.cache=true</span><br><span class="line">spring.freemarker.checkTemplateLocation=true</span><br><span class="line">spring.freemarker.contentType=text/html</span><br><span class="line">spring.freemarker.exposeRequestAttributes=false</span><br><span class="line">spring.freemarker.exposeSessionAttributes=false</span><br><span class="line">spring.freemarker.exposeSpringMacroHelpers=false</span><br><span class="line">spring.freemarker.prefix=</span><br><span class="line">spring.freemarker.requestContextAttribute=</span><br><span class="line">spring.freemarker.settings.*=</span><br><span class="line">spring.freemarker.suffix=.ftl</span><br><span class="line">spring.freemarker.templateEncoding=UTF-8</span><br><span class="line">spring.freemarker.templateLoaderPath=classpath:/templates/</span><br><span class="line">spring.freemarker.viewNames= # whitelist of view names that can be resolved</span><br><span class="line"></span><br><span class="line">#GROOVY TEMPLATES (GroovyTemplateAutoConfiguration)</span><br><span class="line">spring.groovy.template.allowRequestOverride=false</span><br><span class="line">spring.groovy.template.allowSessionOverride=false</span><br><span class="line">spring.groovy.template.cache=true</span><br><span class="line">spring.groovy.template.configuration.*= # See Groovy's TemplateConfiguration</span><br><span class="line">spring.groovy.template.contentType=text/html</span><br><span class="line">spring.groovy.template.prefix=classpath:/templates/</span><br><span class="line">spring.groovy.template.suffix=.tpl</span><br><span class="line">spring.groovy.template.templateEncoding=UTF-8</span><br><span class="line">spring.groovy.template.viewNames= # whitelist of view names that can be resolved</span><br><span class="line"></span><br><span class="line">#VELOCITY TEMPLATES (VelocityAutoConfiguration)</span><br><span class="line">spring.velocity.allowRequestOverride=false</span><br><span class="line">spring.velocity.allowSessionOverride=false</span><br><span class="line">spring.velocity.cache=true</span><br><span class="line">spring.velocity.checkTemplateLocation=true</span><br><span class="line">spring.velocity.contentType=text/html</span><br><span class="line">spring.velocity.dateToolAttribute=</span><br><span class="line">spring.velocity.exposeRequestAttributes=false</span><br><span class="line">spring.velocity.exposeSessionAttributes=false</span><br><span class="line">spring.velocity.exposeSpringMacroHelpers=false</span><br><span class="line">spring.velocity.numberToolAttribute=</span><br><span class="line">spring.velocity.prefix=</span><br><span class="line">spring.velocity.properties.*=</span><br><span class="line">spring.velocity.requestContextAttribute=</span><br><span class="line">spring.velocity.resourceLoaderPath=classpath:/templates/</span><br><span class="line">spring.velocity.suffix=.vm</span><br><span class="line">spring.velocity.templateEncoding=UTF-8</span><br><span class="line">spring.velocity.viewNames= # whitelist of view names that can be resolved</span><br><span class="line"></span><br><span class="line">#INTERNATIONALIZATION (MessageSourceAutoConfiguration)</span><br><span class="line">spring.messages.basename=messages</span><br><span class="line">spring.messages.cacheSeconds=-1</span><br><span class="line">spring.messages.encoding=UTF-8</span><br><span class="line"></span><br><span class="line">#SECURITY (SecurityProperties)</span><br><span class="line">security.user.name=user # login username</span><br><span class="line">security.user.password= # login password</span><br><span class="line">security.user.role=USER # role assigned to the user</span><br><span class="line">security.require-ssl=false # advanced settings ...</span><br><span class="line">security.enable-csrf=false</span><br><span class="line">security.basic.enabled=true</span><br><span class="line">security.basic.realm=Spring</span><br><span class="line">security.basic.path= # /**</span><br><span class="line">security.headers.xss=false</span><br><span class="line">security.headers.cache=false</span><br><span class="line">security.headers.frame=false</span><br><span class="line">security.headers.contentType=false</span><br><span class="line">security.headers.hsts=all # none / domain / all</span><br><span class="line">security.sessions=stateless # always / never / if_required / stateless</span><br><span class="line">security.ignored=false</span><br><span class="line"></span><br><span class="line">#DATASOURCE (DataSourceAutoConfiguration &amp; DataSourceProperties)</span><br><span class="line">spring.datasource.name= # name of the data source</span><br><span class="line">spring.datasource.initialize=true # populate using data.sql</span><br><span class="line">spring.datasource.schema= # a schema (DDL) script resource reference</span><br><span class="line">spring.datasource.data= # a data (DML) script resource reference</span><br><span class="line">spring.datasource.platform= # the platform to use in the schema resource (schema-$&#123;platform&#125;.sql)</span><br><span class="line">spring.datasource.continueOnError=false # continue even if can't be initialized</span><br><span class="line">spring.datasource.separator=; # statement separator in SQL initialization scripts</span><br><span class="line">spring.datasource.driverClassName= # JDBC Settings...</span><br><span class="line">spring.datasource.url=</span><br><span class="line">spring.datasource.username=</span><br><span class="line">spring.datasource.password=</span><br><span class="line">spring.datasource.max-active=100 # Advanced configuration...</span><br><span class="line">spring.datasource.max-idle=8</span><br><span class="line">spring.datasource.min-idle=8</span><br><span class="line">spring.datasource.initial-size=10</span><br><span class="line">spring.datasource.validation-query=</span><br><span class="line">spring.datasource.test-on-borrow=false</span><br><span class="line">spring.datasource.test-on-return=false</span><br><span class="line">spring.datasource.test-while-idle=</span><br><span class="line">spring.datasource.time-between-eviction-runs-millis=</span><br><span class="line">spring.datasource.min-evictable-idle-time-millis=</span><br><span class="line">spring.datasource.max-wait-millis=</span><br><span class="line"></span><br><span class="line">#MONGODB (MongoProperties)</span><br><span class="line">spring.data.mongodb.host= # the db host</span><br><span class="line">spring.data.mongodb.port=27017 # the connection port (defaults to 27107)</span><br><span class="line">spring.data.mongodb.uri=mongodb://localhost/test # connection URL</span><br><span class="line">spring.data.mongo.repositories.enabled=true # if spring data repository support is enabled</span><br><span class="line"></span><br><span class="line">#JPA (JpaBaseConfiguration, HibernateJpaAutoConfiguration)</span><br><span class="line">spring.jpa.properties.*= # properties to set on the JPA connection</span><br><span class="line">spring.jpa.openInView=true</span><br><span class="line">spring.jpa.show-sql=true</span><br><span class="line">spring.jpa.database-platform=</span><br><span class="line">spring.jpa.database=</span><br><span class="line">spring.jpa.generate-ddl=false # ignored by Hibernate, might be useful for other vendors</span><br><span class="line">spring.jpa.hibernate.naming-strategy= # naming classname</span><br><span class="line">spring.jpa.hibernate.ddl-auto= # defaults to create-drop for embedded dbs</span><br><span class="line">spring.data.jpa.repositories.enabled=true # if spring data repository support is enabled</span><br><span class="line"></span><br><span class="line">#SOLR (SolrProperties&#125;)</span><br><span class="line">spring.data.solr.host=http://127.0.0.1:8983/solr</span><br><span class="line">spring.data.solr.zkHost=</span><br><span class="line">spring.data.solr.repositories.enabled=true # if spring data repository support is enabled</span><br><span class="line"></span><br><span class="line">#ELASTICSEARCH (ElasticsearchProperties&#125;)</span><br><span class="line">spring.data.elasticsearch.cluster-name= # The cluster name (defaults to elasticsearch)</span><br><span class="line">spring.data.elasticsearch.cluster-nodes= # The address(es) of the server node (comma-separated; if not specified starts a client node)</span><br><span class="line">spring.data.elasticsearch.local=true # if local mode should be used with client nodes</span><br><span class="line">spring.data.elasticsearch.repositories.enabled=true # if spring data repository support is enabled</span><br><span class="line"></span><br><span class="line">#FLYWAY (FlywayProperties)</span><br><span class="line">flyway.locations=classpath:db/migrations # locations of migrations scripts</span><br><span class="line">flyway.schemas= # schemas to update</span><br><span class="line">flyway.initVersion= 1 # version to start migration</span><br><span class="line">flyway.prefix=V</span><br><span class="line">flyway.suffix=.sql</span><br><span class="line">flyway.enabled=true</span><br><span class="line">flyway.url= # JDBC url if you want Flyway to create its own DataSource</span><br><span class="line">flyway.user= # JDBC username if you want Flyway to create its own DataSource</span><br><span class="line">flyway.password= # JDBC password if you want Flyway to create its own DataSource</span><br><span class="line"></span><br><span class="line">#LIQUIBASE (LiquibaseProperties)</span><br><span class="line">liquibase.change-log=classpath:/db/changelog/db.changelog-master.yaml</span><br><span class="line">liquibase.contexts= # runtime contexts to use</span><br><span class="line">liquibase.default-schema= # default database schema to use</span><br><span class="line">liquibase.drop-first=false</span><br><span class="line">liquibase.enabled=true</span><br><span class="line"></span><br><span class="line">#JMX</span><br><span class="line">spring.jmx.enabled=true # Expose MBeans from Spring</span><br><span class="line"></span><br><span class="line">#ABBIT (RabbitProperties)</span><br><span class="line">spring.rabbitmq.host= # connection host</span><br><span class="line">spring.rabbitmq.port= # connection port</span><br><span class="line">spring.rabbitmq.addresses= # connection addresses (e.g. myhost:9999,otherhost:1111)</span><br><span class="line">spring.rabbitmq.username= # login user</span><br><span class="line">spring.rabbitmq.password= # login password</span><br><span class="line">spring.rabbitmq.virtualhost=</span><br><span class="line">spring.rabbitmq.dynamic=</span><br><span class="line"></span><br><span class="line">#REDIS (RedisProperties)</span><br><span class="line">spring.redis.host=localhost # server host</span><br><span class="line">spring.redis.password= # server password</span><br><span class="line">spring.redis.port=6379 # connection port</span><br><span class="line">spring.redis.pool.max-idle=8 # pool settings ...</span><br><span class="line">spring.redis.pool.min-idle=0</span><br><span class="line">spring.redis.pool.max-active=8</span><br><span class="line">spring.redis.pool.max-wait=-1</span><br><span class="line"></span><br><span class="line">#ACTIVEMQ (ActiveMQProperties)</span><br><span class="line">spring.activemq.broker-url=tcp://localhost:61616 # connection URL</span><br><span class="line">spring.activemq.user=</span><br><span class="line">spring.activemq.password=</span><br><span class="line">spring.activemq.in-memory=true # broker kind to create if no broker-url is specified</span><br><span class="line">spring.activemq.pooled=false</span><br><span class="line"></span><br><span class="line">#HornetQ (HornetQProperties)</span><br><span class="line">spring.hornetq.mode= # connection mode (native, embedded)</span><br><span class="line">spring.hornetq.host=localhost # hornetQ host (native mode)</span><br><span class="line">spring.hornetq.port=5445 # hornetQ port (native mode)</span><br><span class="line">spring.hornetq.embedded.enabled=true # if the embedded server is enabled (needs hornetq-jms-server.jar)</span><br><span class="line">spring.hornetq.embedded.serverId= # auto-generated id of the embedded server (integer)</span><br><span class="line">spring.hornetq.embedded.persistent=false # message persistence</span><br><span class="line">spring.hornetq.embedded.data-directory= # location of data content (when persistence is enabled)</span><br><span class="line">spring.hornetq.embedded.queues= # comma separate queues to create on startup</span><br><span class="line">spring.hornetq.embedded.topics= # comma separate topics to create on startup</span><br><span class="line">spring.hornetq.embedded.cluster-password= # customer password (randomly generated by default)</span><br><span class="line"></span><br><span class="line">#JMS (JmsProperties)</span><br><span class="line">spring.jms.pub-sub-domain= # false for queue (default), true for topic</span><br><span class="line"></span><br><span class="line">#SPRING BATCH (BatchDatabaseInitializer)</span><br><span class="line">spring.batch.job.names=job1,job2</span><br><span class="line">spring.batch.job.enabled=true</span><br><span class="line">spring.batch.initializer.enabled=true</span><br><span class="line">spring.batch.schema= # batch schema to load</span><br><span class="line"></span><br><span class="line">#AOP</span><br><span class="line">spring.aop.auto=</span><br><span class="line">spring.aop.proxy-target-class=</span><br><span class="line"></span><br><span class="line">#FILE ENCODING (FileEncodingApplicationListener)</span><br><span class="line">spring.mandatory-file-encoding=false</span><br><span class="line"></span><br><span class="line">#SPRING SOCIAL (SocialWebAutoConfiguration)</span><br><span class="line">spring.social.auto-connection-views=true # Set to true for default connection views or false if you provide your own</span><br><span class="line"></span><br><span class="line">#SPRING SOCIAL FACEBOOK (FacebookAutoConfiguration)</span><br><span class="line">spring.social.facebook.app-id= # your application's Facebook App ID</span><br><span class="line">spring.social.facebook.app-secret= # your application's Facebook App Secret</span><br><span class="line"></span><br><span class="line">#SPRING SOCIAL LINKEDIN (LinkedInAutoConfiguration)</span><br><span class="line">spring.social.linkedin.app-id= # your application's LinkedIn App ID</span><br><span class="line">spring.social.linkedin.app-secret= # your application's LinkedIn App Secret</span><br><span class="line"></span><br><span class="line">#SPRING SOCIAL TWITTER (TwitterAutoConfiguration)</span><br><span class="line">spring.social.twitter.app-id= # your application's Twitter App ID</span><br><span class="line">spring.social.twitter.app-secret= # your application's Twitter App Secret</span><br><span class="line"></span><br><span class="line">#SPRING MOBILE SITE PREFERENCE (SitePreferenceAutoConfiguration)</span><br><span class="line">spring.mobile.sitepreference.enabled=true # enabled by default</span><br><span class="line"></span><br><span class="line">#SPRING MOBILE DEVICE VIEWS (DeviceDelegatingViewResolverAutoConfiguration)</span><br><span class="line">spring.mobile.devicedelegatingviewresolver.enabled=true # disabled by default</span><br><span class="line">spring.mobile.devicedelegatingviewresolver.normalPrefix=</span><br><span class="line">spring.mobile.devicedelegatingviewresolver.normalSuffix=</span><br><span class="line">spring.mobile.devicedelegatingviewresolver.mobilePrefix=mobile/</span><br><span class="line">spring.mobile.devicedelegatingviewresolver.mobileSuffix=</span><br><span class="line">spring.mobile.devicedelegatingviewresolver.tabletPrefix=tablet/</span><br><span class="line">spring.mobile.devicedelegatingviewresolver.tabletSuffix=</span><br><span class="line"></span><br><span class="line">######========ACTUATOR PROPERTIES===========</span><br><span class="line"></span><br><span class="line">#MANAGEMENT HTTP SERVER (ManagementServerProperties)</span><br><span class="line">management.port= # defaults to 'server.port'</span><br><span class="line">management.address= # bind to a specific NIC</span><br><span class="line">management.contextPath= # default to '/'</span><br><span class="line"></span><br><span class="line">#ENDPOINTS (AbstractEndpoint subclasses)</span><br><span class="line">endpoints.autoconfig.id=autoconfig</span><br><span class="line">endpoints.autoconfig.sensitive=true</span><br><span class="line">endpoints.autoconfig.enabled=true</span><br><span class="line">endpoints.beans.id=beans</span><br><span class="line">endpoints.beans.sensitive=true</span><br><span class="line">endpoints.beans.enabled=true</span><br><span class="line">endpoints.configprops.id=configprops</span><br><span class="line">endpoints.configprops.sensitive=true</span><br><span class="line">endpoints.configprops.enabled=true</span><br><span class="line">endpoints.configprops.keys-to-sanitize=password,secret</span><br><span class="line">endpoints.dump.id=dump</span><br><span class="line">endpoints.dump.sensitive=true</span><br><span class="line">endpoints.dump.enabled=true</span><br><span class="line">endpoints.env.id=env</span><br><span class="line">endpoints.env.sensitive=true</span><br><span class="line">endpoints.env.enabled=true</span><br><span class="line">endpoints.health.id=health</span><br><span class="line">endpoints.health.sensitive=false</span><br><span class="line">endpoints.health.enabled=true</span><br><span class="line">endpoints.info.id=info</span><br><span class="line">endpoints.info.sensitive=false</span><br><span class="line">endpoints.info.enabled=true</span><br><span class="line">endpoints.metrics.id=metrics</span><br><span class="line">endpoints.metrics.sensitive=true</span><br><span class="line">endpoints.metrics.enabled=true</span><br><span class="line">endpoints.shutdown.id=shutdown</span><br><span class="line">endpoints.shutdown.sensitive=true</span><br><span class="line">endpoints.shutdown.enabled=false</span><br><span class="line">endpoints.trace.id=trace</span><br><span class="line">endpoints.trace.sensitive=true</span><br><span class="line">endpoints.trace.enabled=true</span><br><span class="line"></span><br><span class="line">#MVC ONLY ENDPOINTS</span><br><span class="line">endpoints.jolokia.path=jolokia</span><br><span class="line">endpoints.jolokia.sensitive=true</span><br><span class="line">endpoints.jolokia.enabled=true # when using Jolokia</span><br><span class="line">endpoints.error.path=/error</span><br><span class="line"></span><br><span class="line">#JMX ENDPOINT (EndpointMBeanExportProperties)</span><br><span class="line">endpoints.jmx.enabled=true</span><br><span class="line">endpoints.jmx.domain= # the JMX domain, defaults to 'org.springboot'</span><br><span class="line">endpoints.jmx.unique-names=false</span><br><span class="line">endpoints.jmx.enabled=true</span><br><span class="line">endpoints.jmx.staticNames=</span><br><span class="line"></span><br><span class="line">#JOLOKIA (JolokiaProperties)</span><br><span class="line">jolokia.config.*= # See Jolokia manual</span><br><span class="line"></span><br><span class="line">#REMOTE SHELL</span><br><span class="line">shell.auth=simple # jaas, key, simple, spring</span><br><span class="line">shell.command-refresh-interval=-1</span><br><span class="line">shell.command-path-pattern= # classpath:/commands/, classpath:/crash/commands/</span><br><span class="line">shell.config-path-patterns= # classpath:/crash/</span><br><span class="line">shell.disabled-plugins=false # don't expose plugins</span><br><span class="line">shell.ssh.enabled= # ssh settings ...</span><br><span class="line">shell.ssh.keyPath=</span><br><span class="line">shell.ssh.port=</span><br><span class="line">shell.telnet.enabled= # telnet settings ...</span><br><span class="line">shell.telnet.port=</span><br><span class="line">shell.auth.jaas.domain= # authentication settings ...</span><br><span class="line">shell.auth.key.path=</span><br><span class="line">shell.auth.simple.user.name=</span><br><span class="line">shell.auth.simple.user.password=</span><br><span class="line">shell.auth.spring.roles=</span><br><span class="line"></span><br><span class="line">#GIT INFO</span><br><span class="line">spring.git.properties= # resource ref to generated git info properties file</span><br></pre></td></tr></table></figure>
 

	    
</div>

<div class="center">
			

				<span class="post-meta">		
				<span class="iconfont icon-category"></span>
				<a class="category-link" href="/categories/springBoot/">springBoot</a>
				</span>
		
			

		
				
				<span class="post-meta">
				<span class="iconfont icon-tag"></span>
				<a class="tag-link" href="/tags/springBoot/">springBoot</a>
				</span>			
			


		

		<span class="post-words"><span class="iconfont icon-words"></span>
		14167
		</span>		
</div>		

		
    <a class="article-readmore" href="/2017/12/14/Spring Boot 配置文件application/">阅读更多</a> 
    	
</article>     
     	
      	  	

  		
    	<article class="article">		
	   
	<div class="article-header">
	    
	     <a class="article-title"  href="/2017/12/14/spring Boot简介及入门/">spring Boot简介及入门</a>  
	       
		 

		 <time>2017-12-14 </time>    
	</div>


    <div class="article-excerpt">	
	
  	

	  

	  	<h1 id="1-Spring-Boot简介"><a href="#1-Spring-Boot简介" class="headerlink" title="1.Spring Boot简介"></a>1.Spring Boot简介</h1><p>​       Spring 诞生时是 Java 企业版（Java Enterprise Edition，JEE，也称 J2EE）的轻量级代替品。无需开发重量级的 Enterprise JavaBean（EJB），Spring 为企业级Java 开发提供了一种相对简单的方法，通过依赖注入和面向切面编程，用简单的Java 对象（Plain Old Java Object，POJO）实现了 EJB 的功能。</p>
<p>​       虽然 Spring 的组件代码是轻量级的，但它的配置却是重量级的。一开始，Spring 用 XML 配置，而且是很多 XML 配置。Spring 2.5 引入了基于注解的组件扫描，这消除了大量针对应用程序自身组件的显式 XML 配置。Spring 3.0 引入了基于 Java 的配置，这是一种类型安全的可重构配置方式，可以代替 XML。所有这些配置都代表了开发时的损耗。因为在思考 Spring 特性配置和解决业务问题之间需要进行思维切换，所以写配置挤占了写应用程序逻辑的时间。和所有框架一样，Spring 实用，但与此同时它要求的回报也不少。</p>
<p>​       除此之外，项目的依赖管理也是件吃力不讨好的事情。决定项目里要用哪些库就已经够让人头痛的了，你还要知道这些库的哪个版本和其他库不会有冲突，这难题实在太棘手。并且，依赖管理也是一种损耗，添加依赖不是写应用程序代码。一旦选错了依赖的版本，随之而来的不兼容问题毫无疑问会是生产力杀手。Spring Boot 让这一切成为了过去。</p>
<p>​       Spring Boot 是 Spring 社区较新的一个项目。该项目的目的是帮助开发者更容易的创建基于 Spring 的应用程序和服务，让更多人的人更快的对 Spring 进行入门体验，为 Spring 生态系统提供了一种固定的、约定优于配置风格的框架。</p>
<p>Spring Boot 具有如下特性：</p>
<p>（1）为基于 Spring 的开发提供更快的入门体验</p>
<p>（2）开箱即用，没有代码生成，也无需 XML 配置。同时也可以修改默认值来满足特定的需求。</p>
<p>（3）提供了一些大型项目中常见的非功能性特性，如嵌入式服务器、安全、指标，健康检测、外部配置等。</p>
<p>（4）Spring Boot 并不是不对 Spring 功能上的增强，而是提供了一种快速使用 Spring 的方式。</p>
<h1 id="2-Spring-Boot入门Demo"><a href="#2-Spring-Boot入门Demo" class="headerlink" title="2.Spring Boot入门Demo"></a>2.Spring Boot入门Demo</h1><h2 id="2-1起步依赖"><a href="#2-1起步依赖" class="headerlink" title="2.1起步依赖"></a>2.1起步依赖</h2><p>创建Maven工程 springboot_demo（打包方式jar）  </p>
<p>在pom.xml中添加如下依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">parent</span>&gt;</span>  </span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">      </span><br><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​     spring Boot会自动加载所需要的jar包,而这些jar包正式我们做开发时需要导入的jar包。因为这些jar包被我们刚才引入的spring-boot-starter-web所引用了，所以我们引用spring-boot-starter-web后会自动把依赖传递过来。</p>
<h2 id="2-2-变更JDK版本"><a href="#2-2-变更JDK版本" class="headerlink" title="2.2 变更JDK版本"></a>2.2 变更JDK版本</h2><p>​       我们发现默认情况下工程的JDK版本是1.6 ,而我们通常用使用1.7的版本，所以我们需要在pom.xml中添加以下配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.7<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>添加后更新工程，会发现版本已经变更为1.7</p>
<h2 id="2-3-引导类"><a href="#2-3-引导类" class="headerlink" title="2.3 引导类"></a>2.3 引导类</h2><p>我们需要创建一个引导类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.sms.demo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(Application.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>简单解释一下，@SpringBootApplication其实就是以下三个注解的总和</p>
<p>@Configuration： 用于定义一个配置类</p>
<p>@EnableAutoConfiguration ：Spring Boot会自动根据你jar包的依赖来自动配置项目。</p>
<p>@ComponentScan： 告诉Spring 哪个packages 的用注解标识的类 会被spring自动扫描并且装入bean容器。</p>
<p>我们直接执行这个引导类，会发现控制台出现的这个标识</p>
<p><img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/spring_boot/image4.png" alt="image4"></p>
<h2 id="2-4-Spring-MVC实现Hello-World输出"><a href="#2-4-Spring-MVC实现Hello-World输出" class="headerlink" title="2.4 Spring MVC实现Hello World输出"></a>2.4 Spring MVC实现Hello World输出</h2><p>我们现在开始使用spring MVC框架，实现json数据的输出。如果按照我们原来的做法，需要在web.xml中添加一个DispatcherServlet的配置，再添加一个spring的配置文件，配置文件中需要添加如下配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">&lt;!-- 使用组件扫描，不用将controller在spring中配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"cn.itcast.demo.controller"</span> /&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 使用注解驱动不用在下边定义映射器和适配置器 --&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mvc:message-converters</span> <span class="attr">register-defaults</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.alibaba.fastjson.support.spring.FastJsonHttpMessageConverter"</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"supportedMediaTypes"</span> <span class="attr">value</span>=<span class="string">"application/json"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"features"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>WriteMapNullValue<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>WriteDateUseDateFormat<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>但是我们用SpringBoot，这一切都省了。我们直接写Controller类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.sms.demo.controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/info"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">info</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"HelloWorld"</span>;		</span><br><span class="line">	&#125;		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们运行启动类来运行程序</p>
<p>在浏览器地址栏输入 <a href="http://localhost:8080/info" target="_blank" rel="noopener">http://localhost:8080/info</a> 即可看到运行结果</p>
<h1 id="3-springBoot支持修改配置文件"><a href="#3-springBoot支持修改配置文件" class="headerlink" title="3 springBoot支持修改配置文件"></a>3 springBoot支持修改配置文件</h1><h2 id="3-1-修改tomcat启动端口"><a href="#3-1-修改tomcat启动端口" class="headerlink" title="3.1 修改tomcat启动端口"></a>3.1 修改tomcat启动端口</h2><p>在src/main/resources下创建application.properties</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server.port=8088</span><br></pre></td></tr></table></figure>
<p>重新运行引导类。地址栏输入</p>
<p><a href="http://localhost:8088/info" target="_blank" rel="noopener">http://localhost:8088/info</a></p>
<h2 id="3-2-读取配置文件信息"><a href="#3-2-读取配置文件信息" class="headerlink" title="3.2 读取配置文件信息"></a>3.2 读取配置文件信息</h2><p>在src/main/resources下的application.properties 增加配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url=http://www.baidu.com</span><br></pre></td></tr></table></figure>
<p>我要在类中读取这个配置信息，修改HelloWorldController  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> Environment env;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/info"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">info</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"HelloWorld~~"</span>+env.getProperty(<span class="string">"url"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
 

	    
</div>

<div class="center">
			

				<span class="post-meta">		
				<span class="iconfont icon-category"></span>
				<a class="category-link" href="/categories/springBoot/">springBoot</a>
				</span>
		
			

		
				
				<span class="post-meta">
				<span class="iconfont icon-tag"></span>
				<a class="tag-link" href="/tags/springBoot/">springBoot</a>
				</span>			
			


		

		<span class="post-words"><span class="iconfont icon-words"></span>
		3843
		</span>		
</div>		

		
    <a class="article-readmore" href="/2017/12/14/spring Boot简介及入门/">阅读更多</a> 
    	
</article>     
     	
      	  	

  		
    	<article class="article">		
	   
	<div class="article-header">
	    
	     <a class="article-title"  href="/2017/12/11/hadoop编译/">hadoop编译</a>  
	       
		 

		 <time>2017-12-11 </time>    
	</div>


    <div class="article-excerpt">	
	
  	

	  

	  	<p>一、说明</p>
<p>官网下的Hadoop jar包是通用版，实际生产环境下有可能出现一些问题，因此我们需要重新编译hadoop的jar包，使其适应生产环境</p>
<p>二、安装JDK</p>
<p>　   JDK的安装百度一下有很多文章，我使用的是 jdk-7u71-linux-x64.tar.gz。在oracle的官网上也能够下载。jdk的安装在linux下就是一个加压缩的过程。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> cd  /root</span><br><span class="line"></span><br><span class="line"> tar -zxvf jdk-7u71-linux-x64.tar.gz</span><br><span class="line"></span><br><span class="line"> 配置环境变量：vim /etc/profile</span><br><span class="line"></span><br><span class="line"> 输入命令进入编辑模式：i</span><br><span class="line"></span><br><span class="line">在文件最后添加：export JAVA_HOME=/root/jdk1.7.0_71</span><br><span class="line"></span><br><span class="line"> export PATH=.:PATH:JAVA_HOME/bin</span><br><span class="line"></span><br><span class="line">保存退出（按下Esc，输入冒号，输入wq回车）</span><br><span class="line"></span><br><span class="line"> 使环境变量生效：source  /etc/profile</span><br><span class="line"></span><br><span class="line"> 检测安装是否成功：</span><br><span class="line"></span><br><span class="line"> java  -version</span><br><span class="line"></span><br><span class="line"> javac  -version</span><br></pre></td></tr></table></figure>
<p>三、安装maven</p>
<p>​    这个和安装jdk是一样的，安装成后同样需要配置环境变量　</p>
<p>链接:<a href="https://pan.baidu.com/s/1wjOj9qxGqoU_dUS2-hFFKg" target="_blank" rel="noopener">https://pan.baidu.com/s/1wjOj9qxGqoU_dUS2-hFFKg</a>  密码:0n6b</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export MAVEN_HOME=/usr/mvn/apache-maven-3.2.5</span><br><span class="line"></span><br><span class="line">export PATH=.:PATH:JAVA_HOME/bin:$MAVEN_HOME/bin</span><br></pre></td></tr></table></figure>
<p>​    同样，输入命令使配置文件生效　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>
<p>​    检测是否安装成功：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn  -version</span><br></pre></td></tr></table></figure>
<p>​    能够看到关于maven的一些信息，包括所使用的jdk</p>
<p>四、安装protobuf　　</p>
<p>​    这一步比较关键，protobuf最好是提前下载然后上传上去。安装protobuf前，需要安装一些其他的东西</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum  install  gcc    安装c++</span><br><span class="line"></span><br><span class="line">yum  install  gcc-c++          然后会两次提示输入 y（yes/no）</span><br><span class="line"></span><br><span class="line">yum install  make          可能会提示因为make已经是最新版本，而不会安装，这个无所谓，反正是最新版本，就不安装了</span><br></pre></td></tr></table></figure>
<p>  接下来便是安装protobuf，同样是一个解压缩的过程</p>
<p>链接:<a href="https://pan.baidu.com/s/12PT2s-cs-3rO2xevl9QiTA" target="_blank" rel="noopener">https://pan.baidu.com/s/12PT2s-cs-3rO2xevl9QiTA</a>  密码:po5j</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd  /root</span><br><span class="line"></span><br><span class="line">tar -zxvf protobuf-2.5.0.tar.gz</span><br></pre></td></tr></table></figure>
<p>​    然后进入到安装目录中，以此输入一下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd  /protobuf-2.5.0</span><br><span class="line"></span><br><span class="line"> ./ configure</span><br><span class="line"></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line">make  install</span><br></pre></td></tr></table></figure>
<p>   我在进行上面第二个命令，对configure进行预编译时报错，查看异常后，是c++没有安装成功，便再一次执行了：yum install  gcc-c++ 命令，OK<br>   make  命令执行的时间比较长，最后一个命令的执行安装，如果出现错误，重新来过即可</p>
<p>   测试   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protoc  --version</span><br></pre></td></tr></table></figure>
<p>五、安装CMake</p>
<p>　   CMake 需要2.6以上的版本，在安装的时候会提示输入 y/N，同时由于安装这个组件是需要联网的，故根据网速不同，安装的进度也不一样　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum  install  cmake     </span><br><span class="line">yum  install  openssl-devel</span><br><span class="line">yum  install  ncurses-devel</span><br></pre></td></tr></table></figure>
<p>六、ant安装</p>
<p>链接:<a href="https://pan.baidu.com/s/1wulCv25ix1lWztjnG8SJtw" target="_blank" rel="noopener">https://pan.baidu.com/s/1wulCv25ix1lWztjnG8SJtw</a>  密码:fal7</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf  apache-ant-1.9.4-bin.tar.gz</span><br></pre></td></tr></table></figure>
<p>​    配置环境变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export ANT_HOME=/root/apache-ant-1.9.4</span><br><span class="line">export PATH=.:PATH:JAVA_HOME/bin:MAVEN_HOME/bin:ANT_HOME/bin</span><br></pre></td></tr></table></figure>
<p>​    生效以及测试　　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br><span class="line">ant  -version</span><br></pre></td></tr></table></figure>
<p>七、编译hadoop</p>
<p>  1、解压hadoop源码包　　</p>
<p><a href="https://pan.baidu.com/s/1vR5ZPZ9xtmOnqbCqKOa8Sg" target="_blank" rel="noopener">Hadoop-2.7.4源码</a>        提取密码:971h</p>
<p> tar -zxvf hadoop-2.5.2-src.tar.gz</p>
<p>​    进入文件夹里面，里面有一个文件BUILDINT.txt，打开即可看见里面关于编译hadoop的一些环境要求　　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /root/hadoop-2.5.2-src/</span><br><span class="line"></span><br><span class="line">cd hadoop-2.5.2-src</span><br></pre></td></tr></table></figure>
<p>​    2、编译hadoop<br>​       进入解压后的原文件中，即上面查看BUILDING.txt文件目录，然后输入一下命令即可　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mvn package -Pdist,native -DskipTests -Dtar</span><br><span class="line"></span><br><span class="line">        或者是下面的命令　</span><br><span class="line"></span><br><span class="line">mvn  package -DeskipTests -Pdist,native</span><br></pre></td></tr></table></figure>
<p>​    3、等带编译结果</p>
<p>​    　　编译完成后会有提示，SUCCESS / FAILURE。如下</p>
<p>　　　 <img src="https://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/image2.png" alt="image2"></p>
<p>　　　　如果编译失败，向上滚动，变能够查看什么地方出错了。</p>
<p>​    4、查看编译结果　</p>
<p>　　   同样在刚刚进行编译的那个目录下，有一个 hadoop-dist文件夹，进入里面的target文件夹，然后就可以看到编译成功64位的hadoop文件，解压后的在 hadoop-2.5.2 这个文件夹中，同时还生成了一个压缩包：hadoop-2.5.2-tar.gz 这个压缩包可以拷贝到别的机器上进行安装 </p>
<p> 5、几个编译好的Hadoop版本</p>
<p><a href="https://pan.baidu.com/s/1XMxSkBX-A8VtPdE4SmRZ9Q" target="_blank" rel="noopener">centos6.7</a>        密码:c83v</p>
<p><a href="https://pan.baidu.com/s/1TltMZDqqG306VeGKDauuZw" target="_blank" rel="noopener">windows</a>          密码:8fvc</p>
<p><a href="https://pan.baidu.com/s/1uRHVUq8RDY3XoELVoNjVSA" target="_blank" rel="noopener">Mac</a>                 密码:da6s</p>
 

	    
</div>

<div class="center">
			

				<span class="post-meta">		
				<span class="iconfont icon-category"></span>
				<a class="category-link" href="/categories/大数据/">大数据</a>
				</span>
		
			

		
				
				<span class="post-meta">
				<span class="iconfont icon-tag"></span>
				<a class="tag-link" href="/tags/Hadoop/">Hadoop</a> <a class="tag-link" href="/tags/集群搭建/">集群搭建</a>
				</span>			
			


		

		<span class="post-words"><span class="iconfont icon-words"></span>
		2264
		</span>		
</div>		

		
    <a class="article-readmore" href="/2017/12/11/hadoop编译/">阅读更多</a> 
    	
</article>     
     	
      	  	

  		
    	<article class="article">		
	   
	<div class="article-header">
	    
	     <a class="article-title"  href="/2017/11/25/IDEA快捷键/">IDEA快捷键</a>  
	       
		 

		 <time>2017-11-25 </time>    
	</div>


    <div class="article-excerpt">	
	
  	

	  

	  	<h1 id="下面列出常用的一些快捷键以及改键位置："><a href="#下面列出常用的一些快捷键以及改键位置：" class="headerlink" title="下面列出常用的一些快捷键以及改键位置："></a>下面列出常用的一些快捷键以及改键位置：</h1><table>
<thead>
<tr>
<th>快捷键含义</th>
<th>Intellij Idea中设置位置</th>
<th>快捷键组合</th>
</tr>
</thead>
<tbody>
<tr>
<td>代码控制</td>
<td></td>
<td></td>
</tr>
<tr>
<td>自动完成</td>
<td>Main menu/Code/Completion/Basic</td>
<td>ctrl+Space</td>
</tr>
<tr>
<td>自动导入</td>
<td>Main menu/Code/Optimize imports</td>
<td>command+shift+o</td>
</tr>
<tr>
<td>格式化代码</td>
<td>Main menu/Code/Reformat code</td>
<td>command+shift+f</td>
</tr>
<tr>
<td>进入定义</td>
<td>Main menu/Navigate/Declaration</td>
<td>换成Mac版Eclipse之后，这个定义是Ctrl+鼠标左键，但这个不好用，会同时打开菜单,可以改成command+鼠标左键</td>
</tr>
<tr>
<td>重命名</td>
<td>Main menu/Refactor/Rename</td>
<td>fn+shift+F6</td>
</tr>
<tr>
<td>快速修复</td>
<td>Other/Show Intention Action</td>
<td>command+1</td>
</tr>
<tr>
<td>进入并查看光标所在的类或方法</td>
<td></td>
<td>fn+F3  或 ctrl+鼠标左键</td>
</tr>
<tr>
<td>删除当前行</td>
<td>Editor Actions/Delete Line</td>
<td>command+d</td>
</tr>
<tr>
<td>复制当前行</td>
<td>Editor Actions/Duplicate Lines</td>
<td>command+ctrl+方向键下</td>
</tr>
<tr>
<td>当前行向下移动</td>
<td>Main menu/Code/Move Line Down</td>
<td>c无预定义，设定为options+方向键下</td>
</tr>
<tr>
<td>当前行向上移动</td>
<td>Main menu/Code/Move Line Up</td>
<td>无预定义，设定为options+方向键上</td>
</tr>
<tr>
<td>注释当前行</td>
<td>Main menu/Code/Comment with Line Comment</td>
<td>command+/</td>
</tr>
<tr>
<td>运行</td>
<td>Main menu/Run/Run</td>
<td>command+shift+fn+F11</td>
</tr>
<tr>
<td>跳转到某行</td>
<td>Main menu/Navigate/Line</td>
<td>command+L</td>
</tr>
<tr>
<td>返回上一个浏览位置</td>
<td>Main menu/Navigate/Back</td>
<td>command+[</td>
</tr>
<tr>
<td>跳转下一个浏览位置</td>
<td>Main menu/Navigate/Forward</td>
<td>command+]</td>
</tr>
<tr>
<td>查看当前类结构</td>
<td>Main menu/Navigate/File Structure</td>
<td>command+o</td>
</tr>
<tr>
<td>查找</td>
<td></td>
<td></td>
</tr>
<tr>
<td>当前文件查找下一个</td>
<td>Main menu/Edit/Find/Find Word At Caret</td>
<td>无预定义，建议用command+k取代Find Word Next的默认值</td>
</tr>
<tr>
<td>当前文件查找上一个</td>
<td>Main menu/Edit/Find/Find Previous</td>
<td>command+shift+k</td>
</tr>
<tr>
<td>当前文件查找/替换</td>
<td>Main menu/Edit/Find/Replace</td>
<td>无预定义，设定为command+f</td>
</tr>
<tr>
<td>全局查找选中的文本（只是查找字符串）</td>
<td>Main menu/Edit/Find/Find in Path</td>
<td>ctrl+h</td>
</tr>
<tr>
<td>全局查找选中的文本（带完整包名）</td>
<td>Main menu/Edit/Find/Find Usages</td>
<td>command+shift+G</td>
</tr>
<tr>
<td>界面设置</td>
<td></td>
<td></td>
</tr>
<tr>
<td>光标跳转到当前行开始</td>
<td>Editor Actions/Move Cart To Line Start</td>
<td>Home（fn+方向左）</td>
</tr>
<tr>
<td>光标跳转到当前行末尾</td>
<td>Editor Actions/Move Cart To Line End</td>
<td>End（fn+方向右）</td>
</tr>
<tr>
<td>光标跳转到文件开始</td>
<td>Editor Actions/Move Cart To Text Start</td>
<td>command+Home</td>
</tr>
</tbody>
</table>
<p>对于Intellij Idea中的”自动导入”快捷键，其效果不像Eclipse中那么强大，只会清理掉无用的包引入语句，并不会将所需的包自动引入。这个问题可以间接用下面的方法来解决：<br>    1    不要写完一行然后批量引入，而在需要引入的地方使用”快速修复”来逐个引入；<br>    2    复制过来的代码，按照下面的方法设置一下，当粘贴时，Intellij Idea会自动引入正确的包：<br>Preferences——Editor——Auto Import，在右侧的界面中选中全部：</p>
<p>Eclipse中又一个很好用的功能，是查找光标所在的单词，在Intellij Idea中，对应的必须设置Find Word At Caret Next，而不要设置Find Word Next。<br>如果要向上查找当前单词，用Find Word Previous</p>
 

	    
</div>

<div class="center">
			

				<span class="post-meta">		
				<span class="iconfont icon-category"></span>
				<a class="category-link" href="/categories/快捷键/">快捷键</a>
				</span>
		
			

		
				
				<span class="post-meta">
				<span class="iconfont icon-tag"></span>
				<a class="tag-link" href="/tags/快捷键/">快捷键</a>
				</span>			
			


		

		<span class="post-words"><span class="iconfont icon-words"></span>
		1789
		</span>		
</div>		

		
    <a class="article-readmore" href="/2017/11/25/IDEA快捷键/">阅读更多</a> 
    	
</article>     
     	
      	  	

  		
    	<article class="article">		
	   
	<div class="article-header">
	    
	     <a class="article-title"  href="/2017/11/11/Linux集群资源监控/">Linux集群资源监控</a>  
	       
		 

		 <time>2017-11-11 </time>    
	</div>


    <div class="article-excerpt">	
	
  	

	  

	  	<h1 id="一、介绍"><a href="#一、介绍" class="headerlink" title="一、介绍"></a>一、介绍</h1><ul>
<li>Ganglia 监控套件包括三个主要部分 gmond ，gmetad，和网页接口，通常被称为ganglia-web。<br>gmond 是一个守护进程，他运行在每一个需要监测的节点上，收集监测统计，发送和接受在同一个组播或单播通道上的统计信息。</li>
<li>gmetad 也是一个守护进程，他定期检查gmonds ，从那里拉取数据，并将他们的指标存储在RRD存储引擎中。它可以查询多个集群并聚合指标。RRD也被用于生成用户界面的web前端。</li>
<li>ganglia-web 顾名思义，他应该安装在有gmetad运行的机器上，以便读取RRD文件。</li>
</ul>
<p>​    一般来说一个集群的每台机器上都需要安装gmond，只要负责展示web界面的机器安装了gmetad即可。</p>
<h1 id="二-ganglia规划"><a href="#二-ganglia规划" class="headerlink" title="二.ganglia规划"></a>二.ganglia规划</h1><p>​    <strong>主机名</strong>             ip               <strong>规划</strong>                         安装</p>
<p>   hadoop1      10.2.6.250        服务端   ganglia-gmond、ganglia-gmetad、ganglia-web</p>
<p>   hadoop2     10.2.6.246        客户端            ganglia-gmond</p>
<p>   hadoop3     10.2.6.248        客户端            ganglia-gmond</p>
<p>   hadoop4   10.2.6.249        客户端            ganglia-gmond</p>
<p>安装前确保iptables关闭.</p>
<h1 id="三-安装前的准备工作"><a href="#三-安装前的准备工作" class="headerlink" title="三.安装前的准备工作"></a>三.安装前的准备工作</h1><h2 id="3-1加载yum源，在每一台机器上面执行下面两个命令"><a href="#3-1加载yum源，在每一台机器上面执行下面两个命令" class="headerlink" title="3.1加载yum源，在每一台机器上面执行下面两个命令"></a>3.1加载yum源，在每一台机器上面执行下面两个命令</h2><p>rpm -Uvh <a href="http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm" target="_blank" rel="noopener">http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm</a></p>
<p>yum  -y  install  httpd-devel  automake  autoconf  libtool  ncurses-devel  libxslt  groff  pcre-devel  pkgconfig</p>
<h2 id="四-主节点服务安装配置"><a href="#四-主节点服务安装配置" class="headerlink" title="四.主节点服务安装配置"></a>四.主节点服务安装配置</h2><h2 id="4-1主节点的服务安装（hadoop1上面的安装配置）安装ganglia-gmetad-和ganglia-web"><a href="#4-1主节点的服务安装（hadoop1上面的安装配置）安装ganglia-gmetad-和ganglia-web" class="headerlink" title="4.1主节点的服务安装（hadoop1上面的安装配置）安装ganglia-gmetad 和ganglia-web"></a>4.1主节点的服务安装（hadoop1上面的安装配置）安装ganglia-gmetad 和ganglia-web</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">yum search ganglia     ------------------查看ganglia在epel的安装包,复制进行安装 </span><br><span class="line">如果没有安装包，需要下载EPEL</span><br><span class="line">yum  install epel-release  //扩展包更新包  </span><br><span class="line">yum  update //更新yum源  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">yum -y install ganglia-web.x86_64 ganglia-gmond.x86_64  </span><br><span class="line">yum -y install ganglia-gmetad.x86_64 ----------------------(如果上一步执行了这步不用执行,web包会自动下载该依赖)  </span><br><span class="line">rpm -qa |grep ganglia          --------------------查看安装情况  </span><br><span class="line">rpm -ql ganglia-gmetad.x86_64       ------------- 复制上面命令执行结果的安装名,可查看安装路径</span><br></pre></td></tr></table></figure>
<h3 id="4-1-1配置gmetad"><a href="#4-1-1配置gmetad" class="headerlink" title="4.1.1配置gmetad"></a>4.1.1配置gmetad</h3><p>Shell<strong>代码</strong>   </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/ganglia/gmetad.conf  </span><br><span class="line"></span><br><span class="line">data_source "my cluster" 10.2.6.250:8649  ---- Hadoop为cluster名称,后面是需要监控的主机名</span><br></pre></td></tr></table></figure>
<h3 id="4-1-2修改apache设置"><a href="#4-1-2修改apache设置" class="headerlink" title="4.1.2修改apache设置"></a>4.1.2修改apache设置</h3><p>Shell<strong>代码</strong>   </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> vi /etc/httpd/conf.d/ganglia.conf  </span><br><span class="line"></span><br><span class="line">文件内容Deny from all 为 allow from all </span><br><span class="line"></span><br><span class="line">修改后配置如下</span><br><span class="line"></span><br><span class="line">&lt;Location /ganglia&gt;</span><br><span class="line"></span><br><span class="line">    Order deny,allow</span><br><span class="line"></span><br><span class="line">    Allow from all</span><br><span class="line"></span><br><span class="line">    Allow from 127.0.0.1</span><br><span class="line"></span><br><span class="line">    Allow from ::1</span><br><span class="line"></span><br><span class="line">    # Allow from .example.com</span><br><span class="line"></span><br><span class="line">  &lt;/Location&gt;</span><br></pre></td></tr></table></figure>
<h3 id="4-1-3设置启动"><a href="#4-1-3设置启动" class="headerlink" title="4.1.3设置启动"></a>4.1.3设置启动</h3><p>Shell<strong>代码</strong>   </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --add gmetad  </span><br><span class="line"></span><br><span class="line"> chkconfig --add gmond  </span><br><span class="line"></span><br><span class="line"> chkconfig --add httpd</span><br></pre></td></tr></table></figure>
<h3 id="4-1-4打开端口-关闭防火墙"><a href="#4-1-4打开端口-关闭防火墙" class="headerlink" title="4.1.4打开端口/关闭防火墙"></a>4.1.4打开端口/关闭防火墙</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/iptables stop -------------------关闭防火墙,用于测试时,线上最好用打开端口方式</span><br></pre></td></tr></table></figure>
<h3 id="4-1-5关闭SELinux"><a href="#4-1-5关闭SELinux" class="headerlink" title="4.1.5关闭SELinux"></a>4.1.5关闭SELinux</h3><p>1 永久方法 – 需要重启服务器</p>
<p>修改/etc/selinux/config文件中设置SELINUX=disabled ，然后重启服务器。</p>
<p>2 临时方法 – 设置系统参数</p>
<p>使用命令setenforce 0</p>
<p>附：</p>
<p>setenforce 1 设置SELinux 成为enforcing模式</p>
<p>setenforce 0 设置SELinux 成为permissive模式</p>
<h1 id="五-监控节点的安装（每个监控节点，hadoop2，hadoop3，hadoop4都要安装）"><a href="#五-监控节点的安装（每个监控节点，hadoop2，hadoop3，hadoop4都要安装）" class="headerlink" title="五.监控节点的安装（每个监控节点，hadoop2，hadoop3，hadoop4都要安装）"></a>五.监控节点的安装（每个监控节点，hadoop2，hadoop3，hadoop4都要安装）</h1><h2 id="5-1安装ganglia-gmond"><a href="#5-1安装ganglia-gmond" class="headerlink" title="5.1安装ganglia-gmond"></a>5.1安装ganglia-gmond</h2><p>Shell<strong>代码</strong>   </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum search ganglia  </span><br><span class="line"></span><br><span class="line">yum install ganglia-gmond.x86_64</span><br></pre></td></tr></table></figure>
<h2 id="5-2配置gmond"><a href="#5-2配置gmond" class="headerlink" title="5.2配置gmond"></a>5.2配置gmond</h2><p>Shell<strong>代码</strong>   </p>
<p>vi /etc/ganglia/gmond.conf  </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">cluster &#123;</span><br><span class="line"></span><br><span class="line">  name = "my cluster"    ------ cluster名称,是你在gmetad.conf里配置的data_source名称 </span><br><span class="line"></span><br><span class="line">  owner = "root"</span><br><span class="line"></span><br><span class="line">  latlong = "unspecified"</span><br><span class="line"></span><br><span class="line">  url = "unspecified"</span><br><span class="line"></span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">udp_send_channel &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta"> #</span> mcast_join = 239.2.11.71  ----- 组播  </span><br><span class="line"></span><br><span class="line">  host=10.2.6.250    -------------- 单播 gmeta主机的ip/主机名或者主机ip地址  </span><br><span class="line"></span><br><span class="line">  port = 8649</span><br><span class="line"></span><br><span class="line">ttl = 1</span><br><span class="line"></span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">udp_recv_channel &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">  #</span>mcast_join = 239.2.11.71  </span><br><span class="line"></span><br><span class="line">  port = 8649</span><br><span class="line"></span><br><span class="line">  bind = 10.2.6.246</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-3配置启动"><a href="#5-3配置启动" class="headerlink" title="5.3配置启动"></a>5.3配置启动</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chkconfig  --add  gmond</span><br><span class="line"></span><br><span class="line">chkconfig  --list  gmond</span><br></pre></td></tr></table></figure>
<p>此时，如果正确安装，会出现gmond           0:off   1:off   2:off   3:off   4:off   5:off   6:off</p>
<h2 id="5-4配置hosts"><a href="#5-4配置hosts" class="headerlink" title="5.4配置hosts"></a>5.4配置hosts</h2><p> vi /etc/hosts</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">10.2.6.250 hadoop1</span><br><span class="line"></span><br><span class="line">10.2.6.246 hadoop2</span><br><span class="line"></span><br><span class="line">10.2.6.248 hadoop3</span><br><span class="line"></span><br><span class="line">10.2.6.249 hadoop4</span><br></pre></td></tr></table></figure>
<p><strong>全部安装完毕后</strong></p>
<p>在主机上</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">service gmetad start</span><br><span class="line"></span><br><span class="line">service gmond start</span><br><span class="line"></span><br><span class="line">service httpd start</span><br><span class="line"></span><br><span class="line">service gmetad status    -------------------验证是否启动成功</span><br><span class="line"></span><br><span class="line">service gmond status   -------------------验证是否启动成功</span><br></pre></td></tr></table></figure>
<p>在监控节点上</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service gmond start  </span><br><span class="line"></span><br><span class="line">service gmond status   -------------------验证是否启动成功</span><br></pre></td></tr></table></figure>
<p>访问<a href="http://10.2.6.250/ganglia" target="_blank" rel="noopener">http://10.2.6.250/ganglia</a></p>
<h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><p>Forbidden错误时,因为对apache有一个设置</p>
<p>修改 /etc/httpd/conf.d/ganglia.conf文件内容Deny from all 为 allow from all</p>
<p>There was an error collecting ganglia data (127.0.0.1:8652):fsockopen error: Permission denied </p>
<p>解决方法</p>
<p>1 永久方法 – 需要重启服务器</p>
<p>修改/etc/selinux/config文件中设置SELINUX=disabled ，然后重启服务器。</p>
<p>2 临时方法 – 设置系统参数</p>
<p>使用命令setenforce 0</p>
<p>附：</p>
<p>setenforce 1 设置SELinux 成为enforcing模式</p>
<p>setenforce 0 设置SELinux 成为permissive模式</p>
<p><strong>There was an error collecting ganglia data (127.0.0.1:8652):fsockopen error: Connection refused **</strong>解决办法**</p>
<p>卸载yum remove ganglia-web ganglia-gmetad</p>
<p>重新安装yum install ganglia-web    —– ganglia-web本身有引用gmetad</p>
<p>重启即可</p>
<p><a href="http://redhatdebian.blog.51cto.com/1197273/828992" target="_blank" rel="noopener">http://redhatdebian.blog.51cto.com/1197273/828992</a></p>
 

	    
</div>

<div class="center">
			

				<span class="post-meta">		
				<span class="iconfont icon-category"></span>
				<a class="category-link" href="/categories/大数据/">大数据</a>
				</span>
		
			

		
				
				<span class="post-meta">
				<span class="iconfont icon-tag"></span>
				<a class="tag-link" href="/tags/集群/">集群</a>
				</span>			
			


		

		<span class="post-words"><span class="iconfont icon-words"></span>
		3477
		</span>		
</div>		

		
    <a class="article-readmore" href="/2017/11/11/Linux集群资源监控/">阅读更多</a> 
    	
</article>     
     	
      	  	

  		
    	<article class="article">		
	   
	<div class="article-header">
	    
	     <a class="article-title"  href="/2017/11/05/Redis使用/">Redis使用</a>  
	       
		 

		 <time>2017-11-05 </time>    
	</div>


    <div class="article-excerpt">	
	
  	

	  

	  	<h1 id="1、Redis五种数据类型"><a href="#1、Redis五种数据类型" class="headerlink" title="1、Redis五种数据类型"></a>1、Redis五种数据类型</h1><pre><code>1、字符串（String）
2、哈希（hash）
3、字符串列表（list）
4、字符串集合（set）
5、有序字符串集合（sorted set）
</code></pre><h1 id="2、字符串类型"><a href="#2、字符串类型" class="headerlink" title="2、字符串类型"></a>2、字符串类型</h1><h2 id="2-1、赋值"><a href="#2-1、赋值" class="headerlink" title="2.1、赋值"></a>2.1、赋值</h2><p>set key value：设定key持有指定的字符串value，如果该key存在则进行覆盖操作。总是返回”OK”<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/set%20key%20value.png" alt="set key value"></p>
<h2 id="2-2、取值"><a href="#2-2、取值" class="headerlink" title="2.2、取值"></a>2.2、取值</h2><p>get key：获取key的value。如果与该key关联的value不是String类型，redis将返回错误信息，因为get命令只能用于获取String value；如果该key不存在，返回(nil)。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/get%20key.png" alt="get key"><br>getset key value：先获取该key的值，然后在设置该key的值。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/getset%20key%20value.png" alt="getset key value"></p>
<h2 id="2-3、删除"><a href="#2-3、删除" class="headerlink" title="2.3、删除"></a>2.3、删除</h2><p>del key ：删除指定key<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/del%20key.png" alt="del key"></p>
<h2 id="2-4、数值增减"><a href="#2-4、数值增减" class="headerlink" title="2.4、数值增减"></a>2.4、数值增减</h2><p>incr key：将指定的key的value原子性的递增1.如果该key不存在，其初始值为0，在incr之后其值为1。如果value的值不能转成整型，如hello，该操作将执行失败并返回相应的错误信息。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/incr%20key.png" alt="incr key"><br>decr key：将指定的key的value原子性的递减1.如果该key不存在，其初始值为0，在incr之后其值为-1。如果value的值不能转成整型，如hello，该操作将执行失败并返回相应的错误信息。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/decr%20key.png" alt="decr key"></p>
<h2 id="2-5、扩展命令"><a href="#2-5、扩展命令" class="headerlink" title="2.5、扩展命令"></a>2.5、扩展命令</h2><p>incrby key increment：将指定的key的value原子性增加increment，如果该key不存在，器初始值为0，在incrby之后，该值为increment。如果该值不能转成整型，如hello则失败并返回错误信息<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/incrby%20key%20increment.png" alt="incrby key increment"><br>decrby key decrement：将指定的key的value原子性减少decrement，如果该key不存在，器初始值为0，在decrby之后，该值为decrement。如果该值不能转成整型，如hello则失败并返回错误信息<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/decrby%20key%20decrement.png" alt="decrby key decrement"><br>append key value：拼凑字符串。如果该key存在，则在原有的value后追加该值；如果该key不存在，则重新创建一个key/value<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/append%20key%20value.png" alt="append key value"></p>
<h1 id="3、hash数据类型"><a href="#3、hash数据类型" class="headerlink" title="3、hash数据类型"></a>3、hash数据类型</h1><h2 id="3-1、概述"><a href="#3-1、概述" class="headerlink" title="3.1、概述"></a>3.1、概述</h2><p>   Redis中的Hash类型可以看成具有String Key和String Value的map容器。所以该类型非常适合于存储值对象的信息。如Username、Password和Age等。如果Hash中包含很少的字段，那么该类型的数据也将仅占用很少的磁盘空间。每一个Hash可以存储4294967295个键值对。</p>
<h2 id="3-2、存值"><a href="#3-2、存值" class="headerlink" title="3.2、存值"></a>3.2、存值</h2><p>hset key field value<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/hset%20key%20field%20value.png" alt="hset key field value"><br>hmset key field value field value<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/hmset%20key%20field%20value%20field%20value.png" alt="hmset key field value field value"></p>
<h2 id="3-3、取值"><a href="#3-3、取值" class="headerlink" title="3.3、取值"></a>3.3、取值</h2><p>hget key field：返回指定的key中的field的值<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/hget%20key%20field.png" alt="hget key field"><br>hmget key fileds：获取key中的多个filed的值<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/hmget%20key%20fileds.png" alt="hmget key fileds"><br>hgetall key：获取key中的所有filed-vaule<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/hgetall%20key.png" alt="hgetall key"></p>
<h2 id="3-4、删除"><a href="#3-4、删除" class="headerlink" title="3.4、删除"></a>3.4、删除</h2><p>hdel key field [field … ] ：可以删除一个或多个字段，返回值是被删除的字段个数<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/hdel%20key%20field%20%5Bfield%20%E2%80%A6%20%5D1.png" alt="hdel key field [field … ]1"><br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/hdel%20key%20field%20%5Bfield%20%E2%80%A6%20%5D2.png" alt="hdel key field [field … ]2"><br>del key ：删除整个内容<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/del%20key%20.png" alt="del key"></p>
<h2 id="3-5、增加数字"><a href="#3-5、增加数字" class="headerlink" title="3.5、增加数字"></a>3.5、增加数字</h2><p>hincrby key field value：为某个key的某个属性增加值<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/hincrby%20key%20field%20value.png" alt="hincrby key field value"></p>
<h2 id="3-6、自学命令"><a href="#3-6、自学命令" class="headerlink" title="3.6、自学命令"></a>3.6、自学命令</h2><p>hexists key field：判断指定的key中的filed是否存在<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/hexists%20key%20field.png" alt="hexists key field"><br>hlen key：获取key所包含的field的数量<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/hlen%20key.png" alt="hlen key"><br>hkeys key ：获得所有的key<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/hkeys%20key.png" alt="hkeys key"><br>hvals key：获得所有的value<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/hvals%20key.png" alt="hvals key"></p>
<h1 id="4、list类型"><a href="#4、list类型" class="headerlink" title="4、list类型"></a>4、list类型</h1><h2 id="4-1、概述"><a href="#4-1、概述" class="headerlink" title="4.1、概述"></a>4.1、概述</h2><p>在Redis中，List类型是按照插入顺序排序的字符串链表。和数据结构中的普通链表一样，我们可以在其头部(left)和尾部(right)添加新的元素。在插入时，如果该键并不存在，Redis将为该键创建一个新的链表。与此相反，如果链表中所有的元素均被移除，那么该键也将会被从数据库中删除。List中可以包含的最大元素数量是4294967295。<br>    从元素插入和删除的效率视角来看，如果我们是在链表的两头插入或删除元素，这将会是非常高效的操作，即使链表中已经存储了百万条记录，该操作也可以在常量时间内完成。然而需要说明的是，如果元素插入或删除操作是作用于链表中间，那将会是非常低效的。相信对于有良好数据结构基础的开发者而言，这一点并不难理解。<br>  1、ArrayList使用数组方式存储数据，所以根据索引查询数据速度快，而新增或者删除元素时需要设计到位移操作，所以比较慢。<br>  2、LinkedList使用双向链接方式存储数据，每个元素都记录前后元素的指针，所以插入、删除数据时只是更改前后元素的指针指向即可，速度非常快，然后通过下标查询元素时需要从头开始索引，所以比较慢。<br>  3、双向链表中添加数据<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image39.png" alt="image39"><br>  4、双向链表中删除数据<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image40.png" alt="image40"></p>
<h2 id="4-2、常用命令"><a href="#4-2、常用命令" class="headerlink" title="4.2、常用命令"></a>4.2、常用命令</h2><h3 id="4-2-1、两端添加"><a href="#4-2-1、两端添加" class="headerlink" title="4.2.1、两端添加"></a>4.2.1、两端添加</h3><p>lpush key values[value1 value2…]：在指定的key所关联的list的头部插入所有的values，如果该key不存在，该命令在插入的之前创建一个与该key关联的空链表，之后再向该链表的头部插入数据。插入成功，返回元素的个数。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/lpush%20key%20values%5Bvalue1%20value2%E2%80%A6%5D.png" alt="lpush key values"><br>rpush key values[value1、value2…]：在该list的尾部添加元素。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/rpush%20key%20values%5Bvalue1%E3%80%81value2%E2%80%A6%5D.png" alt="rpush key values"></p>
<h3 id="4-2-2、查看列表"><a href="#4-2-2、查看列表" class="headerlink" title="4.2.2、查看列表"></a>4.2.2、查看列表</h3><p>lrange key start end：获取链表中从start到end的元素的值，start、end从0开始计数；也可为负数，若为-1则表示链表尾部的元素，-2则表示倒数第二个，依次类推…<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/lrange%20key%20start%20end1.png" alt="lrange key start end1"><br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/lrange%20key%20start%20end2.png" alt="lrange key start end2"></p>
<h3 id="4-2-3、两端弹出"><a href="#4-2-3、两端弹出" class="headerlink" title="4.2.3、两端弹出"></a>4.2.3、两端弹出</h3><p>lpop key：返回并弹出指定的key关联的链表中的第一个元素，即头部元素。如果该key不存在，返回nil；若key存在，则返回链表的头部元素。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/lpop%20key.png" alt="lpop key"><br>rpop key：从尾部弹出元素。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/rpop%20key.png" alt="rpop key"></p>
<h3 id="4-2-4、获取列表中元素的个数"><a href="#4-2-4、获取列表中元素的个数" class="headerlink" title="4.2.4、获取列表中元素的个数"></a>4.2.4、获取列表中元素的个数</h3><p>llen key：返回指定的key关联的链表中的元素的数量。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/llen%20key.png" alt="llen key"></p>
<h3 id="4-2-5、扩展命令"><a href="#4-2-5、扩展命令" class="headerlink" title="4.2.5、扩展命令"></a>4.2.5、扩展命令</h3><p>lpushx key value：仅当参数中指定的key存在时，向关联的list的头部插入value。如果不存在，将不进行插入<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/lpushx%20key%20value.png" alt="lpushx key value"><br>rpushx key value：在该list的尾部添加元素<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/rpushx%20key%20value.png" alt="rpushx key value"><br>lrem key count value：删除count个值为value的元素，如果count大于0，从头向尾遍历并删除count个值为value的元素，如果count小于0，则从尾向头遍历并删除。如果count等于0，则删除链表中所有等于value的元素。<br>0)初始化数据<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/lrem%20key%20count%20value.png" alt="lrem key count value"><br> 1) 从头删除，2个数字“3”<br>lrem mylist3 2 3<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/lrem%20mylist3%202%203.png" alt="lrem mylist3 2 3"><br>2) 从尾删除，2个数字“1”<br>lrem mylist3 -2 1<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/lrem%20mylist3%20-2%201.png" alt="lrem mylist3 -2 1"><br>3) 删除所有数字“2”<br>lrem mylist3 0 2<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/lrem%20mylist3%200%202.png" alt="lrem mylist3 0 2"><br>lset key index value：设置链表中的index的脚标的元素值，0代表链表的头元素，-1代表链表的尾元素。操作链表的脚标不存在则抛异常。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/lset%20key%20index%20value.png" alt="lset key index value"><br>linsert key before|after pivot value：在pivot元素前或者后插入value这个元素。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/linsert%20key%20before%7Cafter%20pivot%20value.png" alt="linsert key before|after pivot value"><br>rpoplpush resource destination：将链表中的尾部元素弹出并添加到头部。[循环操作]<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/rpoplpush%20resource%20destination.png" alt="rpoplpush resource destination"><br>1) 将mylist5右端弹出，压入到mylist6左边。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/mylist5.png" alt="mylist5"><br>2) 将mylist6右端数据弹出，压入到左端<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/mylist6.png" alt="mylist6"></p>
<h2 id="4-3、使用场景"><a href="#4-3、使用场景" class="headerlink" title="4.3、使用场景"></a>4.3、使用场景</h2><p>rpoplpush的使用场景：<br>Redis链表经常会被用于消息队列的服务，以完成多程序之间的消息交换。假设一个应用程序正在执行LPUSH操作向链表中添加新的元素，我们通常将这样的程序称之为”生产者(Producer)”，而另外一个应用程序正在执行RPOP操作从链表中取出元素，我们称这样的程序为”消费者(Consumer)”。如果此时，消费者程序在取出消息元素后立刻崩溃，由于该消息已经被取出且没有被正常处理，那么我们就可以认为该消息已经丢失，由此可能会导致业务数据丢失，或业务状态的不一致等现象的发生。然而通过使用RPOPLPUSH命令，消费者程序在从主消息队列中取出消息之后再将其插入到备份队列中，直到消费者程序完成正常的处理逻辑后再将该消息从备份队列中删除。同时我们还可以提供一个守护进程，当发现备份队列中的消息过期时，可以重新将其再放回到主消息队列中，以便其它的消费者程序继续处理。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/rpoplpush%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF.png" alt="rpoplpush的使用场景"></p>
<h1 id="5、存储set"><a href="#5、存储set" class="headerlink" title="5、存储set"></a>5、存储set</h1><h2 id="5-1、概述"><a href="#5-1、概述" class="headerlink" title="5.1、概述"></a>5.1、概述</h2><pre><code>在Redis中，我们可以将Set类型看作为没有排序的字符集合，和List类型一样，我们也可以在该类型的数据值上执行添加、删除或判断某一元素是否存在等操作。需要说明的是，这些操作的时间复杂度为O(1)，即常量时间内完成次操作。Set可包含的最大元素数量是4294967295。
和List类型不同的是，Set集合中不允许出现重复的元素，这一点和C++标准库中的set容器是完全相同的。换句话说，如果多次添加相同元素，Set中将仅保留该元素的一份拷贝。和List类型相比，Set类型在功能上还存在着一个非常重要的特性，即在服务器端完成多个Sets之间的聚合计算操作，如unions、intersections和differences。由于这些操作均在服务端完成，因此效率极高，而且也节省了大量的网络IO开销。
</code></pre><h2 id="5-2、常用命令"><a href="#5-2、常用命令" class="headerlink" title="5.2、常用命令"></a>5.2、常用命令</h2><h3 id="5-2-1、添加-删除元素"><a href="#5-2-1、添加-删除元素" class="headerlink" title="5.2.1、添加/删除元素"></a>5.2.1、添加/删除元素</h3><p>sadd key values[value1、value2…]：向set中添加数据，如果该key的值已有则不会重复添加<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/sadd%20key%20values.png" alt="sadd key values"><br>srem key members[member1、member2…]：删除set中指定的成员<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/srem%20key%20members.png" alt="srem key members"></p>
<h3 id="5-2-2、获得集合中的元素"><a href="#5-2-2、获得集合中的元素" class="headerlink" title="5.2.2、获得集合中的元素"></a>5.2.2、获得集合中的元素</h3><p>smembers key：获取set中所有的成员<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/smembers%20key.png" alt="smembers key"><br>sismember key member：判断参数中指定的成员是否在该set中，1表示存在，0表示不存在或者该key本身就不存在。（无论集合中有多少元素都可以极速的返回结果）<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/sismember%20key%20member.png" alt="sismember key member"></p>
<h3 id="5-2-3、集合的差集运算-A-B"><a href="#5-2-3、集合的差集运算-A-B" class="headerlink" title="5.2.3、集合的差集运算 A-B"></a>5.2.3、集合的差集运算 A-B</h3><p>sdiff key1 key2…：返回key1与key2中相差的成员，而且与key的顺序有关。即返回差集。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/sdiff%20key1%20key2_1.png" alt="sdiff key1 key2_1">（属于A并且不属于B的元素构成的集合）<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/sdiff%20key1%20key2_2.png" alt="sdiff key1 key2_2"></p>
<h3 id="5-2-4、集合的交集运算-A-∩-B"><a href="#5-2-4、集合的交集运算-A-∩-B" class="headerlink" title="5.2.4、集合的交集运算 A ∩ B"></a>5.2.4、集合的交集运算 A ∩ B</h3><p>sinter key1 key2 key3…：返回交集。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/sinter%20key1%20key2%20key3.png" alt="sinter key1 key2 key3">（属于A且属于B的元素构成的集合）<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image67.png" alt="image67"></p>
<h3 id="5-2-5、集合的并集运算-A-∪-B"><a href="#5-2-5、集合的并集运算-A-∪-B" class="headerlink" title="5.2.5、集合的并集运算 A ∪ B"></a>5.2.5、集合的并集运算 A ∪ B</h3><p>sunion key1 key2 key3…：返回并集<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/sunion%20key1%20key2%20key3_1.png" alt="sunion key1 key2 key3_1">（属于A或者属于B的元素构成的集合）<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/sunion%20key1%20key2%20key3_2.png" alt="sunion key1 key2 key3_2"></p>
<h3 id="5-2-6、扩展命令"><a href="#5-2-6、扩展命令" class="headerlink" title="5.2.6、扩展命令"></a>5.2.6、扩展命令</h3><p>scard key：获取set中成员的数量<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/scard%20key.png" alt="scard key"><br>srandmember key：随机返回set中的一个成员<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/srandmember%20key.png" alt="srandmember key"><br>sdiffstore destination key1 key2…：将key1、key2相差的成员存储在destination上<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/sdiffstore%20destination%20key1%20key2.png" alt="sdiffstore destination key1 key2"><br>sinterstore destination key[key…]：将返回的交集存储在destination上<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/sinterstore%20destination%20key.png" alt="sinterstore destination key"><br>sunionstore destination key[key…]：将返回的并集存储在destination上<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/sunionstore%20destination%20key.png" alt="sunionstore destination key"></p>
<h2 id="5-3、使用场景"><a href="#5-3、使用场景" class="headerlink" title="5.3、使用场景"></a>5.3、使用场景</h2><p>  1、可以使用Redis的Set数据类型跟踪一些唯一性数据，比如访问某一博客的唯一IP地址信息。对于此场景，我们仅需在每次访问该博客时将访问者的IP存入Redis中，Set数据类型会自动保证IP地址的唯一性。<br>  2、充分利用Set类型的服务端聚合操作方便、高效的特性，可以用于维护数据对象之间的关联关系。比如所有购买某一电子设备的客户ID被存储在一个指定的Set中，而购买另外一种电子产品的客户ID被存储在另外一个Set中，如果此时我们想获取有哪些客户同时购买了这两种商品时，Set的intersections命令就可以充分发挥它的方便和效率的优势了。</p>
<h1 id="6、存储sortedset"><a href="#6、存储sortedset" class="headerlink" title="6、存储sortedset"></a>6、存储sortedset</h1><h2 id="6-1、概述"><a href="#6-1、概述" class="headerlink" title="6.1、概述"></a>6.1、概述</h2><p>  Sorted-Set和Set类型极为相似，它们都是字符串的集合，都不允许重复的成员出现在一个Set中。它们之间的主要差别是Sorted-Set中的每一个成员都会有一个分数(score)与之关联，Redis正是通过分数来为集合中的成员进行从小到大的排序。然而需要额外指出的是，尽管Sorted-Set中的成员必须是唯一的，但是分数(score)却是可以重复的。<br>  在Sorted-Set中添加、删除或更新一个成员都是非常快速的操作，其时间复杂度为集合中成员数量的对数。由于Sorted-Set中的成员在集合中的位置是有序的，因此，即便是访问位于集合中部的成员也仍然是非常高效的。事实上，Redis所具有的这一特征在很多其它类型的数据库中是很难实现的，换句话说，在该点上要想达到和Redis同样的高效，在其它数据库中进行建模是非常困难的。<br>    例如：游戏排名、微博热点话题等使用场景。</p>
<h2 id="6-2、常用命令"><a href="#6-2、常用命令" class="headerlink" title="6.2、常用命令"></a>6.2、常用命令</h2><h3 id="6-2-1、添加元素"><a href="#6-2-1、添加元素" class="headerlink" title="6.2.1、添加元素"></a>6.2.1、添加元素</h3><p>zadd key score member score2 member2 … ：将所有成员以及该成员的分数存放到sorted-set中。如果该元素已经存在则会用新的分数替换原有的分数。返回值是新加入到集合中的元素个数，不包含之前已经存在的元素<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image75.png" alt="image75"><br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image76.png" alt="image76"></p>
<h3 id="6-2-2、获得元素"><a href="#6-2-2、获得元素" class="headerlink" title="6.2.2、获得元素"></a>6.2.2、获得元素</h3><p>zscore key member：返回指定成员的分数<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image77.png" alt="image77"><br>zcard key：获取集合中的成员数量<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image78.png" alt="image78"></p>
<h3 id="6-2-3、删除元素"><a href="#6-2-3、删除元素" class="headerlink" title="6.2.3、删除元素"></a>6.2.3、删除元素</h3><p>zrem key member[member…]：移除集合中指定的成员，可以指定多个成员。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image79.png" alt="image79"></p>
<h3 id="6-2-4、范围查询"><a href="#6-2-4、范围查询" class="headerlink" title="6.2.4、范围查询"></a>6.2.4、范围查询</h3><p>zrange key start end [withscores]：获取集合中脚标为start-end的成员，[withscores]参数表明返回的成员包含其分数<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image80.png" alt="image80"><br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image81.png" alt="image81"><br>zrevrange key start stop [withscores]：照元素分数从大到小的顺序返回索引从start到stop之间的所有元素（包含两端的元素）<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image82.png" alt="image82"><br>zremrangebyrank key start stop: 按照排名范围删除元素<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image83.png" alt="image83"><br>zremrangebyscore key min max：按照分数范围删除元素<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image84.png" alt="image84"></p>
<h3 id="6-2-5、扩展命令"><a href="#6-2-5、扩展命令" class="headerlink" title="6.2.5、扩展命令"></a>6.2.5、扩展命令</h3><p>zrangebyscore key min max [withscores] [limit offset count]：返回分数在[min,max]的成员并按照分数从低到高排序。[withscores]：显示分数；[limit offset count]：offset，表明从脚标为offset的元素开始并返回count个成员。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image85.png" alt="image85"><br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image86.png" alt="image86"><br>zincrby key increment member：设置指定成员的增加的分数。返回值是更改后的分数。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image87.png" alt="image87"><br>zcount key min max：获取分数在[min,max]之间的成员<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image88.png" alt="image88"><br>zrank key member：返回成员在集合中的排名。（从小到大）<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image89.png" alt="image89"><br>zrevrank key member：返回成员在集合中的排名。（从大到小）<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image90.png" alt="image90"></p>
<h2 id="6-3、使用场景"><a href="#6-3、使用场景" class="headerlink" title="6.3、使用场景"></a>6.3、使用场景</h2><p>  1、可以用于一个大型在线游戏的积分排行榜。每当玩家的分数发生变化时，可以执行ZADD命令更新玩家的分数，此后再通过ZRANGE命令获取积分TOPTEN的用户信息。当然我们也可以利用ZRANK命令通过username来获取玩家的排行信息。最后我们将组合使用ZRANGE和ZRANK命令快速的获取和某个玩家积分相近的其他用户的信息。<br>  2、Sorted-Set类型还可用于构建索引数据。</p>
<h1 id="7、keys的通用操作"><a href="#7、keys的通用操作" class="headerlink" title="7、keys的通用操作"></a>7、keys的通用操作</h1><p>keys pattern：获取所有与pattern匹配的key，返回所有与该key匹配的keys。*表示任意一个或多个字符，?表示任意一个字符<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image91.png" alt="image91"><br>del key1 key2…：删除指定的key<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image92.png" alt="image92"><br>exists key：判断该key是否存在，1代表存在，0代表不存在<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image93.png" alt="image93"><br>rename key newkey：为当前的key重命名<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image94.png" alt="image94"><br>expire key ：设置过期时间，单位：秒<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image95.png" alt="image95"><br>ttl key：获取该key所剩的超时时间，如果没有设置超时，返回-1。如果返回-2表示超时不存在。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image96.png" alt="image96"><br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image97.png" alt="image97"><br>type key：获取指定key的类型。该命令将以字符串的格式返回。    返回的字符串为string、list、set、hash和zset，如果key不存在返回none。<br><img src="http://mrblogimgs.oss-cn-qingdao.aliyuncs.com/img/no-sql/redis%E4%BD%BF%E7%94%A8/image98.png" alt="image98"></p>
 

	    
</div>

<div class="center">
			

				<span class="post-meta">		
				<span class="iconfont icon-category"></span>
				<a class="category-link" href="/categories/redis/">redis</a>
				</span>
		
			

		
				
				<span class="post-meta">
				<span class="iconfont icon-tag"></span>
				<a class="tag-link" href="/tags/redis/">redis</a> <a class="tag-link" href="/tags/命令/">命令</a>
				</span>			
			


		

		<span class="post-words"><span class="iconfont icon-words"></span>
		6313
		</span>		
</div>		

		
    <a class="article-readmore" href="/2017/11/05/Redis使用/">阅读更多</a> 
    	
</article>     
     	
      	  	

  		
    	<article class="article">		
	   
	<div class="article-header">
	    
	     <a class="article-title"  href="/2017/04/12/安装 Ruby, Rails 运行环境/">安装 Ruby, Rails 运行环境</a>  
	       
		 

		 <time>2017-04-12 </time>    
	</div>


    <div class="article-excerpt">	
	
  	

	  

	  	<h2 id="步骤1-－-安装-RVM"><a href="#步骤1-－-安装-RVM" class="headerlink" title="步骤1 － 安装 RVM"></a>步骤1 － 安装 RVM</h2><p>直接以如下命令行安装可能会不成功，因为rvm.io站点有时会被墙：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://get.rvm.io | bash -s stable</span><br><span class="line">#或者</span><br><span class="line">curl -L https://rvm.io | bash -s stable</span><br></pre></td></tr></table></figure>
<p>没关系，我们可以直接从git仓库里下载并安装RVM，首先本地新建文件夹rvm:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir rvm</span><br><span class="line">cd rvm</span><br></pre></td></tr></table></figure>
<p>然后依次执行如下命令:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Install mpapis public key (might need `gpg2` and or `sudo`)</span><br><span class="line">gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3</span><br><span class="line"></span><br><span class="line"># Download the installer</span><br><span class="line">curl -O https://raw.githubusercontent.com/rvm/rvm/master/binscripts/rvm-installer</span><br><span class="line">curl -O https://raw.githubusercontent.com/rvm/rvm/master/binscripts/rvm-installer.asc</span><br><span class="line"></span><br><span class="line"># Verify the installer signature (might need `gpg2`), and if it validates...</span><br><span class="line">gpg --verify rvm-installer.asc &amp;&amp;</span><br><span class="line"></span><br><span class="line"># Run the installer</span><br><span class="line">bash rvm-installer stable</span><br></pre></td></tr></table></figure>
<p>如果gpg –keyserver命令失败，用如下命令代替:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://rvm.io/mpapis.asc | gpg --import -</span><br></pre></td></tr></table></figure>
<p>如果不出什么错误，RVM已经安装到系统上了，可以使用了。然后，载入 RVM 环境（新开 Termal 就不用这么做了，会自动重新载入的）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ source ~/.rvm/scripts/rvm</span><br></pre></td></tr></table></figure>
<p>修改 RVM 下载 Ruby 的源，到 Ruby China 的镜像:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;ruby_url=https://cache.ruby-china.org/pub/ruby&quot; &gt; ~/.rvm/user/db</span><br></pre></td></tr></table></figure>
<p>检查一下是否安装正确</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ rvm -v</span><br><span class="line">rvm 1.22.17 (stable) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https://rvm.io/]</span><br></pre></td></tr></table></figure>
<h2 id="步骤2-－-用-RVM-安装-Ruby-环境"><a href="#步骤2-－-用-RVM-安装-Ruby-环境" class="headerlink" title="步骤2 － 用 RVM 安装 Ruby 环境"></a>步骤2 － 用 RVM 安装 Ruby 环境</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ rvm requirements</span><br><span class="line">$ rvm install 2.3.0</span><br></pre></td></tr></table></figure>
<p>同样继续等待漫长的下载，编译过程，完成以后，Ruby, Ruby Gems 就安装好了。</p>
<h2 id="步骤3-－-设置-Ruby-版本"><a href="#步骤3-－-设置-Ruby-版本" class="headerlink" title="步骤3 － 设置 Ruby 版本"></a>步骤3 － 设置 Ruby 版本</h2><p>RVM 装好以后，需要执行下面的命令将指定版本的 Ruby 设置为系统默认版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rvm use 2.3.0 --default</span><br></pre></td></tr></table></figure>
<p>同样，也可以用其他版本号，前提是你有用 rvm install 安装过那个版本</p>
<p>这个时候你可以测试是否正确</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ ruby -v</span><br><span class="line">ruby 2.3.0 ...</span><br><span class="line"></span><br><span class="line">$ gem -v</span><br><span class="line">2.1.6</span><br><span class="line"></span><br><span class="line">$ gem sources --add https://gems.ruby-china.org/ --remove https://rubygems.org/</span><br></pre></td></tr></table></figure>
<h3 id="安装-Bundler"><a href="#安装-Bundler" class="headerlink" title="安装 Bundler"></a>安装 Bundler</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gem install bundler</span><br></pre></td></tr></table></figure>
<h2 id="步骤4-－-安装-Rails-环境"><a href="#步骤4-－-安装-Rails-环境" class="headerlink" title="步骤4 － 安装 Rails 环境"></a>步骤4 － 安装 Rails 环境</h2><p>上面 3 个步骤过后，Ruby 环境就安装好了，接下来安装 Rails</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gem install rails</span><br></pre></td></tr></table></figure>
<p>然后测试安装是否正确</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ rails -v</span><br><span class="line">Rails 4.2.5</span><br></pre></td></tr></table></figure>
<p>转载：</p>
<p><a href="https://yq.aliyun.com/articles/24866" target="_blank" rel="noopener">inux下安装ruby版本管理器RVM</a></p>
<p><a href="https://ruby-china.org/wiki/install_ruby_guide" target="_blank" rel="noopener">如何快速正确的安装 Ruby, Rails 运行环境</a></p>
 

	    
</div>

<div class="center">
			

				<span class="post-meta">		
				<span class="iconfont icon-category"></span>
				<a class="category-link" href="/categories/redis/">redis</a>
				</span>
		
			

		
				
				<span class="post-meta">
				<span class="iconfont icon-tag"></span>
				<a class="tag-link" href="/tags/redis/">redis</a>
				</span>			
			


		

		<span class="post-words"><span class="iconfont icon-words"></span>
		1582
		</span>		
</div>		

		
    <a class="article-readmore" href="/2017/04/12/安装 Ruby, Rails 运行环境/">阅读更多</a> 
    	
</article>     
     	
  

 

  <nav class="paginator">
    <a class="extend prev" rel="prev" href="/">上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">下一页</a>
  </nav>
  

</section> 

    </div>        

    
    <div class="mask"> </div>
    <div class="back-to-top iconfont icon-backtotop fadeIn"></div> 

    


<script src="/js/search.js"></script>     
          
          <div class="search-container sildeUpMin">
            <input type="text" placeholder="输入你想搜索的" id="search-input" class="search-input">  
              <span class="search-cancel iconfont icon-cancel"></span>
              <div id="search-result" class="search-result"></div>
          </div>
 

     <div class="mobile-menu">      

      
      <img class="mobile-menu-icon no-gallery" src= /img/favicon.png >   
      

         
            

            <a class="mobile-menu-link" href="/">首页
            </a>
            
         
            

            <a class="mobile-menu-link" href="/archives">归档
            </a>
            
         
            

            <a class="mobile-menu-link" href="/categories">分类
            </a>
            
         
            

            <a class="mobile-menu-link" href="/tags">标签
            </a>
            
         
            

            <a class="mobile-menu-link" href="/about">关于
            </a>
            
         
                          

            <a class="mobile-menu-link mobile-menu-search" href="#">搜索 </a>                 
            
         
</div>     
    

<footer id="footer">
	   
   	 <div>	
	   	    	
   	 </div>
   
   	 
	 <div>
	 	&copy;
		2018
		Rui Min	 

	 </div>


   
   	 <div>
	
	 <a href="http://hexo.io/" target="_blank">Hexo</a>

	 Theme

	 <a href="https://github.com/Lemonreds/hexo-theme-Nayo" target="_blank">Nayo</a> 

	 </div>	


	
	
</footer> 
    

<!-- Baidu Analytics -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?636802045446222199ae541e32c8133e"; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




 
  </body>   
  <script src="/js/animation.js"></script>   
</html>